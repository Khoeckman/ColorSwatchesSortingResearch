(function(){"use strict";function g(d,o){return d.splice(o,1)[0]}self.onmessage=function(d){const{N:o,stride:s,distMatrix:S,startIndex:x=0}=d.data,u=Math.sqrt(o);function b(t){const n=new Set,e=t%s,i=Math.floor(t/s),a=Math.floor((o-1)/s);return e>0&&n.add(t-1),e<s-1&&t+1<o&&n.add(t+1),i>0&&n.add(t-s),i<a&&t+s<o&&n.add(t+s),n}const r=Array(o).fill(0).map((t,n)=>n),f=Array(o),w=~~((o+u)/2);f[w]=g(r,x);const l=new Set([w]),N=(t,n)=>{const e=b(t).intersection(l);let i=0;for(const a of e)i+=n[f[a]];return i/e.size**2};let h=new Set,c=0;for(;r.length;){for(const e of b(c))l.has(e)||h.add(e);let t=0,n=1/0;for(let e=0;e<r.length;e++){const i=S[r[e]];let a=0;for(const m of h){const M=N(m,i);if(M<n&&(n=M,t=e,c=m),++a>u/2)break}}f[c]=g(r,t),l.add(c),h.delete(c)}self.postMessage(f)}})();
