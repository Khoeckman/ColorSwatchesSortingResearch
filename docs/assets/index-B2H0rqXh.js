(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();const ct=t=>1/(1+Math.exp(-t*6+3)),At=t=>new Array(t).fill(0).map(()=>[~~(ct(Math.random())*256),~~(ct(Math.random())*256),~~(ct(Math.random())*256)]);class ue{constructor(){this.keyToValue=new Map,this.valueToKey=new Map}set(e,n){this.keyToValue.set(e,n),this.valueToKey.set(n,e)}getByKey(e){return this.keyToValue.get(e)}getByValue(e){return this.valueToKey.get(e)}clear(){this.keyToValue.clear(),this.valueToKey.clear()}}class Ot{constructor(e){this.generateIdentifier=e,this.kv=new ue}register(e,n){this.kv.getByValue(e)||(n||(n=this.generateIdentifier(e)),this.kv.set(n,e))}clear(){this.kv.clear()}getIdentifier(e){return this.kv.getByValue(e)}getValue(e){return this.kv.getByKey(e)}}class he extends Ot{constructor(){super(e=>e.name),this.classToAllowedProps=new Map}register(e,n){typeof n=="object"?(n.allowProps&&this.classToAllowedProps.set(e,n.allowProps),super.register(e,n.identifier)):super.register(e,n)}getAllowedProps(e){return this.classToAllowedProps.get(e)}}function fe(t){if("values"in Object)return Object.values(t);const e=[];for(const n in t)t.hasOwnProperty(n)&&e.push(t[n]);return e}function de(t,e){const n=fe(t);if("find"in n)return n.find(e);const s=n;for(let r=0;r<s.length;r++){const o=s[r];if(e(o))return o}}function C(t,e){Object.entries(t).forEach(([n,s])=>e(s,n))}function Q(t,e){return t.indexOf(e)!==-1}function Pt(t,e){for(let n=0;n<t.length;n++){const s=t[n];if(e(s))return s}}class me{constructor(){this.transfomers={}}register(e){this.transfomers[e.name]=e}findApplicable(e){return de(this.transfomers,n=>n.isApplicable(e))}findByName(e){return this.transfomers[e]}}const ge=t=>Object.prototype.toString.call(t).slice(8,-1),Lt=t=>typeof t>"u",pe=t=>t===null,$=t=>typeof t!="object"||t===null||t===Object.prototype?!1:Object.getPrototypeOf(t)===null?!0:Object.getPrototypeOf(t)===Object.prototype,ht=t=>$(t)&&Object.keys(t).length===0,A=t=>Array.isArray(t),we=t=>typeof t=="string",be=t=>typeof t=="number"&&!isNaN(t),ye=t=>typeof t=="boolean",_e=t=>t instanceof RegExp,U=t=>t instanceof Map,K=t=>t instanceof Set,Ft=t=>ge(t)==="Symbol",ve=t=>t instanceof Date&&!isNaN(t.valueOf()),Vt=t=>t instanceof Error,St=t=>typeof t=="number"&&isNaN(t),ke=t=>ye(t)||pe(t)||Lt(t)||be(t)||we(t)||Ft(t),Me=t=>typeof t=="bigint",Pe=t=>t===1/0||t===-1/0,Se=t=>ArrayBuffer.isView(t)&&!(t instanceof DataView),xe=t=>t instanceof URL,ft=t=>t.replace(/\\/g,"\\\\").replace(/\./g,"\\."),lt=t=>t.map(String).map(ft).join("."),B=(t,e)=>{const n=[];let s="";for(let o=0;o<t.length;o++){let a=t.charAt(o);if(!e&&a==="\\"){const u=t.charAt(o+1);if(u==="\\"){s+="\\",o++;continue}else if(u!==".")throw Error("invalid path")}if(a==="\\"&&t.charAt(o+1)==="."){s+=".",o++;continue}if(a==="."){n.push(s),s="";continue}s+=a}const r=s;return n.push(r),n};function M(t,e,n,s){return{isApplicable:t,annotation:e,transform:n,untransform:s}}const Tt=[M(Lt,"undefined",()=>null,()=>{}),M(Me,"bigint",t=>t.toString(),t=>typeof BigInt<"u"?BigInt(t):(console.error("Please add a BigInt polyfill."),t)),M(ve,"Date",t=>t.toISOString(),t=>new Date(t)),M(Vt,"Error",(t,e)=>{const n={name:t.name,message:t.message};return"cause"in t&&(n.cause=t.cause),e.allowedErrorProps.forEach(s=>{n[s]=t[s]}),n},(t,e)=>{const n=new Error(t.message,{cause:t.cause});return n.name=t.name,n.stack=t.stack,e.allowedErrorProps.forEach(s=>{n[s]=t[s]}),n}),M(_e,"regexp",t=>""+t,t=>{const e=t.slice(1,t.lastIndexOf("/")),n=t.slice(t.lastIndexOf("/")+1);return new RegExp(e,n)}),M(K,"set",t=>[...t.values()],t=>new Set(t)),M(U,"map",t=>[...t.entries()],t=>new Map(t)),M(t=>St(t)||Pe(t),"number",t=>St(t)?"NaN":t>0?"Infinity":"-Infinity",Number),M(t=>t===0&&1/t===-1/0,"number",()=>"-0",Number),M(xe,"URL",t=>t.toString(),t=>new URL(t))];function et(t,e,n,s){return{isApplicable:t,annotation:e,transform:n,untransform:s}}const zt=et((t,e)=>Ft(t)?!!e.symbolRegistry.getIdentifier(t):!1,(t,e)=>["symbol",e.symbolRegistry.getIdentifier(t)],t=>t.description,(t,e,n)=>{const s=n.symbolRegistry.getValue(e[1]);if(!s)throw new Error("Trying to deserialize unknown symbol");return s}),Ee=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,Uint8ClampedArray].reduce((t,e)=>(t[e.name]=e,t),{}),qt=et(Se,t=>["typed-array",t.constructor.name],t=>[...t],(t,e)=>{const n=Ee[e[1]];if(!n)throw new Error("Trying to deserialize unknown typed array");return new n(t)});function Ct(t,e){return t?.constructor?!!e.classRegistry.getIdentifier(t.constructor):!1}const Dt=et(Ct,(t,e)=>["class",e.classRegistry.getIdentifier(t.constructor)],(t,e)=>{const n=e.classRegistry.getAllowedProps(t.constructor);if(!n)return{...t};const s={};return n.forEach(r=>{s[r]=t[r]}),s},(t,e,n)=>{const s=n.classRegistry.getValue(e[1]);if(!s)throw new Error(`Trying to deserialize unknown class '${e[1]}' - check https://github.com/blitz-js/superjson/issues/116#issuecomment-773996564`);return Object.assign(Object.create(s.prototype),t)}),Bt=et((t,e)=>!!e.customTransformerRegistry.findApplicable(t),(t,e)=>["custom",e.customTransformerRegistry.findApplicable(t).name],(t,e)=>e.customTransformerRegistry.findApplicable(t).serialize(t),(t,e,n)=>{const s=n.customTransformerRegistry.findByName(e[1]);if(!s)throw new Error("Trying to deserialize unknown custom value");return s.deserialize(t)}),Ne=[Dt,zt,Bt,qt],xt=(t,e)=>{const n=Pt(Ne,r=>r.isApplicable(t,e));if(n)return{value:n.transform(t,e),type:n.annotation(t,e)};const s=Pt(Tt,r=>r.isApplicable(t,e));if(s)return{value:s.transform(t,e),type:s.annotation}},jt={};Tt.forEach(t=>{jt[t.annotation]=t});const Ie=(t,e,n)=>{if(A(e))switch(e[0]){case"symbol":return zt.untransform(t,e,n);case"class":return Dt.untransform(t,e,n);case"custom":return Bt.untransform(t,e,n);case"typed-array":return qt.untransform(t,e,n);default:throw new Error("Unknown transformation: "+e)}else{const s=jt[e];if(!s)throw new Error("Unknown transformation: "+e);return s.untransform(t,n)}},T=(t,e)=>{if(e>t.size)throw new Error("index out of bounds");const n=t.keys();for(;e>0;)n.next(),e--;return n.next().value};function $t(t){if(Q(t,"__proto__"))throw new Error("__proto__ is not allowed as a property");if(Q(t,"prototype"))throw new Error("prototype is not allowed as a property");if(Q(t,"constructor"))throw new Error("constructor is not allowed as a property")}const Re=(t,e)=>{$t(e);for(let n=0;n<e.length;n++){const s=e[n];if(K(t))t=T(t,+s);else if(U(t)){const r=+s,o=+e[++n]==0?"key":"value",a=T(t,r);switch(o){case"key":t=a;break;case"value":t=t.get(a);break}}else t=t[s]}return t},dt=(t,e,n)=>{if($t(e),e.length===0)return n(t);let s=t;for(let o=0;o<e.length-1;o++){const a=e[o];if(A(s)){const i=+a;s=s[i]}else if($(s))s=s[a];else if(K(s)){const i=+a;s=T(s,i)}else if(U(s)){if(o===e.length-2)break;const c=+a,u=+e[++o]==0?"key":"value",h=T(s,c);switch(u){case"key":s=h;break;case"value":s=s.get(h);break}}}const r=e[e.length-1];if(A(s)?s[+r]=n(s[+r]):$(s)&&(s[r]=n(s[r])),K(s)){const o=T(s,+r),a=n(o);o!==a&&(s.delete(o),s.add(a))}if(U(s)){const o=+e[e.length-2],a=T(s,o);switch(+r==0?"key":"value"){case"key":{const c=n(a);s.set(c,s.get(a)),c!==a&&s.delete(a);break}case"value":{s.set(a,n(s.get(a)));break}}}return t},Ut=t=>t<1;function mt(t,e,n,s=[]){if(!t)return;const r=Ut(n);if(!A(t)){C(t,(i,c)=>mt(i,e,n,[...s,...B(c,r)]));return}const[o,a]=t;a&&C(a,(i,c)=>{mt(i,e,n,[...s,...B(c,r)])}),e(o,s)}function Ae(t,e,n,s){return mt(e,(r,o)=>{t=dt(t,o,a=>Ie(a,r,s))},n),t}function Oe(t,e,n){const s=Ut(n);function r(o,a){const i=Re(t,B(a,s));o.map(c=>B(c,s)).forEach(c=>{t=dt(t,c,()=>i)})}if(A(e)){const[o,a]=e;o.forEach(i=>{t=dt(t,B(i,s),()=>t)}),a&&C(a,r)}else C(e,r);return t}const Le=(t,e)=>$(t)||A(t)||U(t)||K(t)||Vt(t)||Ct(t,e);function Fe(t,e,n){const s=n.get(t);s?s.push(e):n.set(t,[e])}function Ve(t,e){const n={};let s;return t.forEach(r=>{if(r.length<=1)return;e||(r=r.map(i=>i.map(String)).sort((i,c)=>i.length-c.length));const[o,...a]=r;o.length===0?s=a.map(lt):n[lt(o)]=a.map(lt)}),s?ht(n)?[s]:[s,n]:ht(n)?void 0:n}const Kt=(t,e,n,s,r=[],o=[],a=new Map)=>{const i=ke(t);if(!i){Fe(t,r,e);const d=a.get(t);if(d)return s?{transformedValue:null}:d}if(!Le(t,n)){const d=xt(t,n),m=d?{transformedValue:d.value,annotations:[d.type]}:{transformedValue:t};return i||a.set(t,m),m}if(Q(o,t))return{transformedValue:null};const c=xt(t,n),u=c?.value??t,h=A(u)?[]:{},l={};C(u,(d,m)=>{if(m==="__proto__"||m==="constructor"||m==="prototype")throw new Error(`Detected property ${m}. This is a prototype pollution risk, please remove it from your object.`);const p=Kt(d,e,n,s,[...r,m],[...o,t],a);h[m]=p.transformedValue,A(p.annotations)?l[ft(m)]=p.annotations:$(p.annotations)&&C(p.annotations,(y,k)=>{l[ft(m)+"."+k]=y})});const g=ht(l)?{transformedValue:h,annotations:c?[c.type]:void 0}:{transformedValue:h,annotations:c?[c.type,l]:l};return i||a.set(t,g),g};function Wt(t){return Object.prototype.toString.call(t).slice(8,-1)}function Et(t){return Wt(t)==="Array"}function Te(t){if(Wt(t)!=="Object")return!1;const e=Object.getPrototypeOf(t);return!!e&&e.constructor===Object&&e===Object.prototype}function ze(t,e,n,s,r){const o={}.propertyIsEnumerable.call(s,e)?"enumerable":"nonenumerable";o==="enumerable"&&(t[e]=n),r&&o==="nonenumerable"&&Object.defineProperty(t,e,{value:n,enumerable:!1,writable:!0,configurable:!0})}function gt(t,e={}){if(Et(t))return t.map(r=>gt(r,e));if(!Te(t))return t;const n=Object.getOwnPropertyNames(t),s=Object.getOwnPropertySymbols(t);return[...n,...s].reduce((r,o)=>{if(o==="__proto__"||Et(e.props)&&!e.props.includes(o))return r;const a=t[o],i=gt(a,e);return ze(r,o,i,t,e.nonenumerable),r},{})}class w{constructor({dedupe:e=!1}={}){this.classRegistry=new he,this.symbolRegistry=new Ot(n=>n.description??""),this.customTransformerRegistry=new me,this.allowedErrorProps=[],this.dedupe=e}serialize(e){const n=new Map,s=Kt(e,n,this,this.dedupe),r={json:s.transformedValue};s.annotations&&(r.meta={...r.meta,values:s.annotations});const o=Ve(n,this.dedupe);return o&&(r.meta={...r.meta,referentialEqualities:o}),r.meta&&(r.meta.v=1),r}deserialize(e,n){const{json:s,meta:r}=e;let o=n?.inPlace?s:gt(s);return r?.values&&(o=Ae(o,r.values,r.v??0,this)),r?.referentialEqualities&&(o=Oe(o,r.referentialEqualities,r.v??0)),o}stringify(e){return JSON.stringify(this.serialize(e))}parse(e){return this.deserialize(JSON.parse(e),{inPlace:!0})}registerClass(e,n){this.classRegistry.register(e,n)}registerSymbol(e,n){this.symbolRegistry.register(e,n)}registerCustom(e,n){this.customTransformerRegistry.register({name:n,...e})}allowErrorProps(...e){this.allowedErrorProps.push(...e)}}w.defaultInstance=new w;w.serialize=w.defaultInstance.serialize.bind(w.defaultInstance);w.deserialize=w.defaultInstance.deserialize.bind(w.defaultInstance);w.stringify=w.defaultInstance.stringify.bind(w.defaultInstance);w.parse=w.defaultInstance.parse.bind(w.defaultInstance);w.registerClass=w.defaultInstance.registerClass.bind(w.defaultInstance);w.registerSymbol=w.defaultInstance.registerSymbol.bind(w.defaultInstance);w.registerCustom=w.defaultInstance.registerCustom.bind(w.defaultInstance);w.allowErrorProps=w.defaultInstance.allowErrorProps.bind(w.defaultInstance);w.serialize;w.deserialize;w.stringify;w.parse;w.registerClass;w.registerCustom;w.registerSymbol;w.allowErrorProps;class W{static version="6.0.4";static superjson=w;itemName;defaultValue;#e;#n;storage;#t;constructor(e,n,s={}){const{encodeFn:r,decodeFn:o,storage:a=window.localStorage}=s;if(typeof e!="string")throw new TypeError("itemName is not a string");if(this.itemName=e,this.defaultValue=n,r&&typeof r!="function")throw new TypeError("encodeFn is defined but is not a function");if(this.#e=r||(i=>W.superjson.stringify(i)),o&&typeof o!="function")throw new TypeError("decodeFn is defined but is not a function");if(this.#n=o||(i=>W.superjson.parse(i)),!(a instanceof Storage))throw new TypeError("storage must be an instance of Storage");this.storage=a,this.sync()}set value(e){this.#t=e,this.storage.setItem(this.itemName,this.#e(e))}get value(){return this.#t}set(e,n){return typeof e=="function"?this.value=e(this.#t):this.value={...this.#t,[e]:n}}sync(e=this.#n){let n=this.storage.getItem(this.itemName);if(typeof n!="string")return this.reset();try{return this.value=e(n)}catch(s){return console.error(s),this.reset(),s}}reset(){return this.value=this.defaultValue}isDefault(){return this.#t===this.defaultValue}}class Xt{errors=[];validators=[];form;constructor(e){this.form=e,this.resetSummary(),this.form.addEventListener("submit",n=>this.onSubmit(n))}onLoad(){this.resetSummary(),this.removeInlineErrors()}onSubmit(e){this.onLoad(),this.validate()||(e.preventDefault(),e.stopImmediatePropagation(),this.showSummary(),this.showInlineErrors())}validate(){return this.validators.forEach(e=>{if(!e.method(e.field)){if(this.errors.map(n=>n.name).includes(e.name))return;this.errors.push(e)}}),this.errors.length===0}addValidator(e){const n=this.form.elements.namedItem(e.name);n&&this.validators.push({field:n,...e})}createInlineError(e){const n=document.createElement("span");return n.classList.add("field-error"),n.innerText=e.message,n.setAttribute("id",e.name+"-error"),n}showInlineErrors(){this.errors.forEach(e=>{const n=this.createInlineError(e),s=e.field;if(s instanceof Element){if(s.classList.add("invalid"),s.setAttribute("aria-invalid","true"),!("labels"in s&&s.labels instanceof NodeList))return;const r=s.labels[0];r.insertBefore(n,r.lastElementChild)}else s instanceof RadioNodeList&&s.forEach(r=>{r.classList.add("invalid"),r.setAttribute("aria-describedby",n.id),r.setAttribute("aria-invalid","true");const a=s[0].closest("fieldset")?.querySelector("legend");a&&a.appendChild(n)})})}removeInlineErrors(){this.form.querySelectorAll(".field-error").forEach(e=>e.remove()),this.form.querySelectorAll(".invalid").forEach(e=>{e.removeAttribute("aria-describedby"),e.removeAttribute("aria-invalid"),e.classList.remove("invalid")}),this.errors=[]}resetSummary(){const e=this.form.querySelector(".error-summary");e&&(e.style.display="none",e.querySelector("ul").innerHTML="")}showSummary(){const e=this.form.querySelector(".error-summary");if(!e)return;const n=e.querySelector("ul");n&&(this.errors.forEach(s=>{const r=document.createElement("a");r.href="#"+s.name,r.innerText=s.message,r.addEventListener("click",a=>{a.preventDefault();const i=a.currentTarget;if(!i)return;const c=i.getAttribute("href");if(!c)return;const u=document.querySelector(c);u&&(u.focus(),u.scrollIntoView({behavior:"smooth",block:"center"}))});const o=document.createElement("li");o.appendChild(r),n.appendChild(o)}),e.tabIndex=-1,e.style.display="block",e.focus())}}const pt={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};for(const t in pt)Object.freeze(pt[t]);const X=Object.freeze(pt),Yt={};for(const t of Object.keys(X))Yt[X[t]]=t;const f={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},oklab:{channels:3,labels:["okl","oka","okb"]},lch:{channels:3,labels:"lch"},oklch:{channels:3,labels:["okl","okc","okh"]},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}},E=(6/29)**3;function z(t){const e=t>.0031308?1.055*t**.4166666666666667-.055:t*12.92;return Math.min(Math.max(0,e),1)}function q(t){return t>.04045?((t+.055)/1.055)**2.4:t/12.92}for(const t of Object.keys(f)){if(!("channels"in f[t]))throw new Error("missing channels property: "+t);if(!("labels"in f[t]))throw new Error("missing channel labels property: "+t);if(f[t].labels.length!==f[t].channels)throw new Error("channel and label counts mismatch: "+t);const{channels:e,labels:n}=f[t];delete f[t].channels,delete f[t].labels,Object.defineProperty(f[t],"channels",{value:e}),Object.defineProperty(f[t],"labels",{value:n})}f.rgb.hsl=function(t){const e=t[0]/255,n=t[1]/255,s=t[2]/255,r=Math.min(e,n,s),o=Math.max(e,n,s),a=o-r;let i,c;switch(o){case r:{i=0;break}case e:{i=(n-s)/a;break}case n:{i=2+(s-e)/a;break}case s:{i=4+(e-n)/a;break}}i=Math.min(i*60,360),i<0&&(i+=360);const u=(r+o)/2;return o===r?c=0:u<=.5?c=a/(o+r):c=a/(2-o-r),[i,c*100,u*100]};f.rgb.hsv=function(t){let e,n,s,r,o;const a=t[0]/255,i=t[1]/255,c=t[2]/255,u=Math.max(a,i,c),h=u-Math.min(a,i,c),l=function(g){return(u-g)/6/h+1/2};if(h===0)r=0,o=0;else{switch(o=h/u,e=l(a),n=l(i),s=l(c),u){case a:{r=s-n;break}case i:{r=1/3+e-s;break}case c:{r=2/3+n-e;break}}r<0?r+=1:r>1&&(r-=1)}return[r*360,o*100,u*100]};f.rgb.hwb=function(t){const e=t[0],n=t[1];let s=t[2];const r=f.rgb.hsl(t)[0],o=1/255*Math.min(e,Math.min(n,s));return s=1-1/255*Math.max(e,Math.max(n,s)),[r,o*100,s*100]};f.rgb.oklab=function(t){const e=q(t[0]/255),n=q(t[1]/255),s=q(t[2]/255),r=Math.cbrt(.4122214708*e+.5363325363*n+.0514459929*s),o=Math.cbrt(.2119034982*e+.6806995451*n+.1073969566*s),a=Math.cbrt(.0883024619*e+.2817188376*n+.6299787005*s),i=.2104542553*r+.793617785*o-.0040720468*a,c=1.9779984951*r-2.428592205*o+.4505937099*a,u=.0259040371*r+.7827717662*o-.808675766*a;return[i*100,c*100,u*100]};f.rgb.cmyk=function(t){const e=t[0]/255,n=t[1]/255,s=t[2]/255,r=Math.min(1-e,1-n,1-s),o=(1-e-r)/(1-r)||0,a=(1-n-r)/(1-r)||0,i=(1-s-r)/(1-r)||0;return[o*100,a*100,i*100,r*100]};function qe(t,e){return(t[0]-e[0])**2+(t[1]-e[1])**2+(t[2]-e[2])**2}f.rgb.keyword=function(t){const e=Yt[t];if(e)return e;let n=Number.POSITIVE_INFINITY,s;for(const r of Object.keys(X)){const o=X[r],a=qe(t,o);a<n&&(n=a,s=r)}return s};f.keyword.rgb=function(t){return[...X[t]]};f.rgb.xyz=function(t){const e=q(t[0]/255),n=q(t[1]/255),s=q(t[2]/255),r=e*.4124564+n*.3575761+s*.1804375,o=e*.2126729+n*.7151522+s*.072175,a=e*.0193339+n*.119192+s*.9503041;return[r*100,o*100,a*100]};f.rgb.lab=function(t){const e=f.rgb.xyz(t);let n=e[0],s=e[1],r=e[2];n/=95.047,s/=100,r/=108.883,n=n>E?n**(1/3):7.787*n+16/116,s=s>E?s**(1/3):7.787*s+16/116,r=r>E?r**(1/3):7.787*r+16/116;const o=116*s-16,a=500*(n-s),i=200*(s-r);return[o,a,i]};f.hsl.rgb=function(t){const e=t[0]/360,n=t[1]/100,s=t[2]/100;let r,o;if(n===0)return o=s*255,[o,o,o];const a=s<.5?s*(1+n):s+n-s*n,i=2*s-a,c=[0,0,0];for(let u=0;u<3;u++)r=e+1/3*-(u-1),r<0&&r++,r>1&&r--,6*r<1?o=i+(a-i)*6*r:2*r<1?o=a:3*r<2?o=i+(a-i)*(2/3-r)*6:o=i,c[u]=o*255;return c};f.hsl.hsv=function(t){const e=t[0];let n=t[1]/100,s=t[2]/100,r=n;const o=Math.max(s,.01);s*=2,n*=s<=1?s:2-s,r*=o<=1?o:2-o;const a=(s+n)/2,i=s===0?2*r/(o+r):2*n/(s+n);return[e,i*100,a*100]};f.hsv.rgb=function(t){const e=t[0]/60,n=t[1]/100;let s=t[2]/100;const r=Math.floor(e)%6,o=e-Math.floor(e),a=255*s*(1-n),i=255*s*(1-n*o),c=255*s*(1-n*(1-o));switch(s*=255,r){case 0:return[s,c,a];case 1:return[i,s,a];case 2:return[a,s,c];case 3:return[a,i,s];case 4:return[c,a,s];case 5:return[s,a,i]}};f.hsv.hsl=function(t){const e=t[0],n=t[1]/100,s=t[2]/100,r=Math.max(s,.01);let o,a;a=(2-n)*s;const i=(2-n)*r;return o=n*r,o/=i<=1?i:2-i,o=o||0,a/=2,[e,o*100,a*100]};f.hwb.rgb=function(t){const e=t[0]/360;let n=t[1]/100,s=t[2]/100;const r=n+s;let o;r>1&&(n/=r,s/=r);const a=Math.floor(6*e),i=1-s;o=6*e-a,(a&1)!==0&&(o=1-o);const c=n+o*(i-n);let u,h,l;switch(a){default:case 6:case 0:{u=i,h=c,l=n;break}case 1:{u=c,h=i,l=n;break}case 2:{u=n,h=i,l=c;break}case 3:{u=n,h=c,l=i;break}case 4:{u=c,h=n,l=i;break}case 5:{u=i,h=n,l=c;break}}return[u*255,h*255,l*255]};f.cmyk.rgb=function(t){const e=t[0]/100,n=t[1]/100,s=t[2]/100,r=t[3]/100,o=1-Math.min(1,e*(1-r)+r),a=1-Math.min(1,n*(1-r)+r),i=1-Math.min(1,s*(1-r)+r);return[o*255,a*255,i*255]};f.xyz.rgb=function(t){const e=t[0]/100,n=t[1]/100,s=t[2]/100;let r,o,a;return r=e*3.2404542+n*-1.5371385+s*-.4985314,o=e*-.969266+n*1.8760108+s*.041556,a=e*.0556434+n*-.2040259+s*1.0572252,r=z(r),o=z(o),a=z(a),[r*255,o*255,a*255]};f.xyz.lab=function(t){let e=t[0],n=t[1],s=t[2];e/=95.047,n/=100,s/=108.883,e=e>E?e**(1/3):7.787*e+16/116,n=n>E?n**(1/3):7.787*n+16/116,s=s>E?s**(1/3):7.787*s+16/116;const r=116*n-16,o=500*(e-n),a=200*(n-s);return[r,o,a]};f.xyz.oklab=function(t){const e=t[0]/100,n=t[1]/100,s=t[2]/100,r=Math.cbrt(.8189330101*e+.3618667424*n-.1288597137*s),o=Math.cbrt(.0329845436*e+.9293118715*n+.0361456387*s),a=Math.cbrt(.0482003018*e+.2643662691*n+.633851707*s),i=.2104542553*r+.793617785*o-.0040720468*a,c=1.9779984951*r-2.428592205*o+.4505937099*a,u=.0259040371*r+.7827717662*o-.808675766*a;return[i*100,c*100,u*100]};f.oklab.oklch=function(t){return f.lab.lch(t)};f.oklab.xyz=function(t){const e=t[0]/100,n=t[1]/100,s=t[2]/100,r=(.999999998*e+.396337792*n+.215803758*s)**3,o=(1.000000008*e-.105561342*n-.063854175*s)**3,a=(1.000000055*e-.089484182*n-1.291485538*s)**3,i=1.227013851*r-.55779998*o+.281256149*a,c=-.040580178*r+1.11225687*o-.071676679*a,u=-.076381285*r-.421481978*o+1.58616322*a;return[i*100,c*100,u*100]};f.oklab.rgb=function(t){const e=t[0]/100,n=t[1]/100,s=t[2]/100,r=(e+.3963377774*n+.2158037573*s)**3,o=(e-.1055613458*n-.0638541728*s)**3,a=(e-.0894841775*n-1.291485548*s)**3,i=z(4.0767416621*r-3.3077115913*o+.2309699292*a),c=z(-1.2684380046*r+2.6097574011*o-.3413193965*a),u=z(-.0041960863*r-.7034186147*o+1.707614701*a);return[i*255,c*255,u*255]};f.oklch.oklab=function(t){return f.lch.lab(t)};f.lab.xyz=function(t){const e=t[0],n=t[1],s=t[2];let r,o,a;o=(e+16)/116,r=n/500+o,a=o-s/200;const i=o**3,c=r**3,u=a**3;return o=i>E?i:(o-16/116)/7.787,r=c>E?c:(r-16/116)/7.787,a=u>E?u:(a-16/116)/7.787,r*=95.047,o*=100,a*=108.883,[r,o,a]};f.lab.lch=function(t){const e=t[0],n=t[1],s=t[2];let r;r=Math.atan2(s,n)*360/2/Math.PI,r<0&&(r+=360);const a=Math.sqrt(n*n+s*s);return[e,a,r]};f.lch.lab=function(t){const e=t[0],n=t[1],r=t[2]/360*2*Math.PI,o=n*Math.cos(r),a=n*Math.sin(r);return[e,o,a]};f.rgb.ansi16=function(t,e=null){const[n,s,r]=t;let o=e===null?f.rgb.hsv(t)[2]:e;if(o=Math.round(o/50),o===0)return 30;let a=30+(Math.round(r/255)<<2|Math.round(s/255)<<1|Math.round(n/255));return o===2&&(a+=60),a};f.hsv.ansi16=function(t){return f.rgb.ansi16(f.hsv.rgb(t),t[2])};f.rgb.ansi256=function(t){const e=t[0],n=t[1],s=t[2];return e>>4===n>>4&&n>>4===s>>4?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(n/255*5)+Math.round(s/255*5)};f.ansi16.rgb=function(t){t=t[0];let e=t%10;if(e===0||e===7)return t>50&&(e+=3.5),e=e/10.5*255,[e,e,e];const n=(Math.trunc(t>50)+1)*.5,s=(e&1)*n*255,r=(e>>1&1)*n*255,o=(e>>2&1)*n*255;return[s,r,o]};f.ansi256.rgb=function(t){if(t=t[0],t>=232){const o=(t-232)*10+8;return[o,o,o]}t-=16;let e;const n=Math.floor(t/36)/5*255,s=Math.floor((e=t%36)/6)/5*255,r=e%6/5*255;return[n,s,r]};f.rgb.hex=function(t){const n=(((Math.round(t[0])&255)<<16)+((Math.round(t[1])&255)<<8)+(Math.round(t[2])&255)).toString(16).toUpperCase();return"000000".slice(n.length)+n};f.hex.rgb=function(t){const e=t.toString(16).match(/[a-f\d]{6}|[a-f\d]{3}/i);if(!e)return[0,0,0];let n=e[0];e[0].length===3&&(n=[...n].map(i=>i+i).join(""));const s=Number.parseInt(n,16),r=s>>16&255,o=s>>8&255,a=s&255;return[r,o,a]};f.rgb.hcg=function(t){const e=t[0]/255,n=t[1]/255,s=t[2]/255,r=Math.max(Math.max(e,n),s),o=Math.min(Math.min(e,n),s),a=r-o;let i;const c=a<1?o/(1-a):0;return a<=0?i=0:r===e?i=(n-s)/a%6:r===n?i=2+(s-e)/a:i=4+(e-n)/a,i/=6,i%=1,[i*360,a*100,c*100]};f.hsl.hcg=function(t){const e=t[1]/100,n=t[2]/100,s=n<.5?2*e*n:2*e*(1-n);let r=0;return s<1&&(r=(n-.5*s)/(1-s)),[t[0],s*100,r*100]};f.hsv.hcg=function(t){const e=t[1]/100,n=t[2]/100,s=e*n;let r=0;return s<1&&(r=(n-s)/(1-s)),[t[0],s*100,r*100]};f.hcg.rgb=function(t){const e=t[0]/360,n=t[1]/100,s=t[2]/100;if(n===0)return[s*255,s*255,s*255];const r=[0,0,0],o=e%1*6,a=o%1,i=1-a;let c=0;switch(Math.floor(o)){case 0:{r[0]=1,r[1]=a,r[2]=0;break}case 1:{r[0]=i,r[1]=1,r[2]=0;break}case 2:{r[0]=0,r[1]=1,r[2]=a;break}case 3:{r[0]=0,r[1]=i,r[2]=1;break}case 4:{r[0]=a,r[1]=0,r[2]=1;break}default:r[0]=1,r[1]=0,r[2]=i}return c=(1-n)*s,[(n*r[0]+c)*255,(n*r[1]+c)*255,(n*r[2]+c)*255]};f.hcg.hsv=function(t){const e=t[1]/100,n=t[2]/100,s=e+n*(1-e);let r=0;return s>0&&(r=e/s),[t[0],r*100,s*100]};f.hcg.hsl=function(t){const e=t[1]/100,s=t[2]/100*(1-e)+.5*e;let r=0;return s>0&&s<.5?r=e/(2*s):s>=.5&&s<1&&(r=e/(2*(1-s))),[t[0],r*100,s*100]};f.hcg.hwb=function(t){const e=t[1]/100,n=t[2]/100,s=e+n*(1-e);return[t[0],(s-e)*100,(1-s)*100]};f.hwb.hcg=function(t){const e=t[1]/100,s=1-t[2]/100,r=s-e;let o=0;return r<1&&(o=(s-r)/(1-r)),[t[0],r*100,o*100]};f.apple.rgb=function(t){return[t[0]/65535*255,t[1]/65535*255,t[2]/65535*255]};f.rgb.apple=function(t){return[t[0]/255*65535,t[1]/255*65535,t[2]/255*65535]};f.gray.rgb=function(t){return[t[0]/100*255,t[0]/100*255,t[0]/100*255]};f.gray.hsl=function(t){return[0,0,t[0]]};f.gray.hsv=f.gray.hsl;f.gray.hwb=function(t){return[0,100,t[0]]};f.gray.cmyk=function(t){return[0,0,0,t[0]]};f.gray.lab=function(t){return[t[0],0,0]};f.gray.hex=function(t){const e=Math.round(t[0]/100*255)&255,s=((e<<16)+(e<<8)+e).toString(16).toUpperCase();return"000000".slice(s.length)+s};f.rgb.gray=function(t){return[(t[0]+t[1]+t[2])/3/255*100]};function Ce(){const t={},e=Object.keys(f);for(let{length:n}=e,s=0;s<n;s++)t[e[s]]={distance:-1,parent:null};return t}function De(t){const e=Ce(),n=[t];for(e[t].distance=0;n.length>0;){const s=n.pop(),r=Object.keys(f[s]);for(let{length:o}=r,a=0;a<o;a++){const i=r[a],c=e[i];c.distance===-1&&(c.distance=e[s].distance+1,c.parent=s,n.unshift(i))}}return e}function Be(t,e){return function(n){return e(t(n))}}function je(t,e){const n=[e[t].parent,t];let s=f[e[t].parent][t],r=e[t].parent;for(;e[r].parent;)n.unshift(e[r].parent),s=Be(f[e[r].parent][r],s),r=e[r].parent;return s.conversion=n,s}function $e(t){const e=De(t),n={},s=Object.keys(e);for(let{length:r}=s,o=0;o<r;o++){const a=s[o];e[a].parent!==null&&(n[a]=je(a,e))}return n}const b={},Ue=Object.keys(f);function Ke(t){const e=function(...n){const s=n[0];return s==null?s:(s.length>1&&(n=s),t(n))};return"conversion"in t&&(e.conversion=t.conversion),e}function We(t){const e=function(...n){const s=n[0];if(s==null)return s;s.length>1&&(n=s);const r=t(n);if(typeof r=="object")for(let{length:o}=r,a=0;a<o;a++)r[a]=Math.round(r[a]);return r};return"conversion"in t&&(e.conversion=t.conversion),e}for(const t of Ue){b[t]={},Object.defineProperty(b[t],"channels",{value:f[t].channels}),Object.defineProperty(b[t],"labels",{value:f[t].labels});const e=$e(t),n=Object.keys(e);for(const s of n){const r=e[s];b[t][s]=We(r),b[t][s].raw=Ke(r)}}const{atan2:Nt,cos:H,exp:Xe,sin:It,sqrt:x,PI:N}=Math;function Gt([t,e,n],[s,r,o],a={}){const{lightness:i=1,chroma:c=1,hue:u=1}=a,h=s-t,l=n*n,g=o*o,d=x(e*e+l),m=x(r*r+g),p=(t+s)/2,k=((d+m)/2)**7,wt=.5*(1-x(k/(k+6103515625))),nt=e+e*wt,st=r+r*wt,Y=x(nt*nt+l),G=x(st*st+g),rt=(Y+G)/2,se=G-Y,ot=Nt(n,nt)/N*180,bt=Nt(o,st)/N*180;let yt=0,O=0;if(Y===0||G===0)O=ot+bt;else{const Mt=((bt-ot+540)%360-180)/2;yt=2*x(Y*G)*It(Mt/180*N),O=(ot+Mt+360)%360}const re=1+-.17*H((O-30)/180*N)+.24*H(2*O/180*N)+.32*H((3*O+6)/180*N)+-.2*H((4*O-63)/180*N),_t=(p-50)*(p-50),oe=1+.015*_t/x(20+_t),ae=1+.045*rt,ie=1+.015*rt*re,vt=rt**7,ce=2*x(vt/(vt+6103515625)),le=-It(60*Xe(-(((O-275)/25)**2))/180*N)*ce,kt=h/(i*oe),at=se/(c*ae),it=yt/(u*ie);return x(kt*kt+at*at+it*it+le*at*it)}function Ye(t,e){const n=t[0]-e[0],s=t[1]-e[1],r=t[2]-e[2];return n*n+s*s+r*r}function Ht(t,e){const n=b.rgb.lab.raw(t),s=b.rgb.lab.raw(e);return Gt(n,s)}class _{values;N;distMatrix;path;workers=[];destructed=!1;constructor(e,n=1,s=Ht){this.values=e.slice(),this.N=this.values.length,this.path=this.values.map((r,o)=>o),this.distMatrix=this.createDistMatrix(n,s)}static async awaitWorker(e){const n=await new Promise((s,r)=>{const o=i=>{e.removeEventListener("message",o),s(i.data)},a=i=>{e.removeEventListener("error",a),r(i)};e.addEventListener("message",o),e.addEventListener("error",a)});return e.terminate(),n}createDistMatrix(e,n){const s=this.values,r=this.N,o=Array(r).fill(0).map(()=>Array(r).fill(0));for(let a=0;a<r;a++)for(let i=a+1;i<r;i++){const c=Math.pow(n(s[a],s[i]),e);o[a][i]=c,o[i][a]=c}return o}totalDist(){const e=this.path,n=this.distMatrix;let s=0,r=e[0];for(let o=1,a=e.length;o<a;o++){const i=e[o];s+=n[r][i],r=i}return s}async nearestNeighborPath(e=0){if(this.destructed)return;const n=new Worker(new URL("/SortingSwatchesResearch/assets/NNP-CsMNQBdk.js",import.meta.url),{type:"module"});this.workers.push(n),n.postMessage({N:this.N,distMatrix:this.distMatrix,startIndex:e}),this.path=await _.awaitWorker(n)}async twoOpt(){if(this.destructed)return;const e=new Worker(new URL("/SortingSwatchesResearch/assets/twoOpt-DdTLJvVE.js",import.meta.url),{type:"module"});this.workers.push(e),e.postMessage({N:this.N,path:this.path,distMatrix:this.distMatrix}),this.path=await _.awaitWorker(e)}getValuesFromPath(e=this.path){return this.values=(e||this.path).map(n=>this.values[n])}terminateWorkers(){for(const e of this.workers)e.terminate();this.workers=[]}destruct(){this.terminateWorkers(),this.destructed=!0}}const Z=(t,e)=>{const n=b.rgb.lab.raw(t),s=b.rgb.lab.raw(e);return Gt(n,s)};function Ge(t,e=1){const n=t.length;if(n<=1)return 0;let s=0;for(let c=1;c<n;c++)s+=Math.pow(Z(t[c-1],t[c]),e);let r=0;for(let c=0;c<n;c++){let u=1/0;for(let h=0;h<n;h++){if(c===h)continue;const l=Z(t[c],t[h]);l<u&&(u=l)}r+=Math.pow(u,e)}const a=Math.pow(128,e)*(n-1),i=(s-r)/(a-r);return Math.max(0,Math.min(1,i))}function He(t,e){const n=[];return t%e&&t-1>=0&&n.push(t-1),t-e>=0&&n.push(t-e),n}function Qe(t,e,n=1){const s=t.length;if(s<=1)return 0;let r=0;for(let d=0;d<s;d++){const m=He(d,e);for(const p of m)r+=Math.pow(Z(t[d],t[p]),n)}let o=0;for(let d=0;d<s;d++){let m=1/0;for(let p=0;p<s;p++){if(d===p)continue;const y=Z(t[d],t[p]);y<m&&(m=y)}o+=Math.pow(m,n)}const a=128,i=Math.ceil(s/e),c=i*(e-1)-Math.max(0,e-(s%e||e)),u=(i-1)*e,h=c+u,l=Math.pow(a,n)*h,g=(r-o)/(l-o);return Math.max(0,Math.min(1,g))}function Ze(t,e){const n=Math.floor(1/Ge(e,3));t.querySelector(".score").textContent=String(n);const s=t.querySelector("ol");s&&(s.innerHTML="",e.forEach(([r,o,a])=>{const i=document.createElement("li");i.style.backgroundColor=`rgb(${r}, ${o}, ${a})`,s.appendChild(i)}))}let I=[];function Je(t){const e=[...document.querySelector("#one-d + .solutions").children],n=t.length;e.forEach(async(s,r)=>{if(s.classList.contains("not-solution"))return;let o=structuredClone(t);switch(r){case 0:case 1:break;case 2:o.sort(([a,i,c],[u,h,l])=>{const g=Math.atan2(Math.sqrt(3)*(i-c),2*a-i-c),d=Math.atan2(Math.sqrt(3)*(h-l),2*u-h-l);return g-d});break;case 3:o.sort(([a,i,c],[u,h,l])=>{const[,g]=b.rgb.hsl.raw(a,i,c),[,d]=b.rgb.hsl.raw(u,h,l);return g-d});break;case 4:o.sort(([a,i,c],[u,h,l])=>{const[,,g]=b.rgb.hsl.raw(a,i,c),[,,d]=b.rgb.hsl.raw(u,h,l);return g-d});break;case 5:o.sort(([a,i,c],[u,h,l])=>{const[,,g]=b.rgb.hsv.raw(a,i,c),[,,d]=b.rgb.hsv.raw(u,h,l);return g-d});break;case 6:o.sort(([a,i,c],[u,h,l])=>{const[g,d]=b.rgb.hsl.raw(a,i,c),[m,p]=b.rgb.hsl.raw(u,h,l),y=+(d>50),k=+(p>50);return y-k||g-m});break;case 7:o.sort(([a,i,c],[u,h,l])=>{const[g,,d]=b.rgb.hsl.raw(a,i,c),[m,,p]=b.rgb.hsl.raw(u,h,l),y=+(d>50),k=+(p>50);return y-k||g-m});break;case 8:o.sort(([a,i,c],[u,h,l])=>{const[g,,d]=b.rgb.hsv.raw(a,i,c),[m,,p]=b.rgb.hsv.raw(u,h,l),y=+(d>50),k=+(p>50);return y-k||g-m});break;case 9:{o.sort(([i,c,u],[h,l,g])=>{const d=Math.atan2(Math.sqrt(3)*(c-u),2*i-c-u),m=Math.atan2(Math.sqrt(3)*(l-g),2*h-l-g);return d-m});const a=new _(o);I.push(a),await a.twoOpt(),o=a.getValuesFromPath();break}case 10:{if(n<=1)break;const a=new _(o,3);I.push(a),await a.nearestNeighborPath(),o=a.getValuesFromPath();break}case 11:{if(n<=1)break;const a=new _(o,3);I.push(a);let i=[],c=1/0;for(let u=0;u<Math.min(n,120);u++){await a.nearestNeighborPath(u);const h=a.totalDist();h<c&&(c=h,i=a.path)}o=a.getValuesFromPath(i);break}case 12:{if(n<=1)break;const a=new _(o,3);I.push(a),await a.nearestNeighborPath(),await a.twoOpt(),o=a.getValuesFromPath();break}case 13:{if(n<=1)break;const a=new _(o,3);I.push(a);let i=[],c=1/0;for(let u=0;u<Math.min(n,120);u++){await a.nearestNeighborPath(u),await a.twoOpt();const h=a.totalDist();h<c&&(c=h,i=a.path)}o=a.getValuesFromPath(i);break}case 14:{if(n<=1)break;const a=new _(o,3,Ye);I.push(a);let i=[],c=1/0;for(let u=0;u<Math.min(n,120);u++){await a.nearestNeighborPath(u),await a.twoOpt();const h=a.totalDist();h<c&&(c=h,i=a.path)}o=a.getValuesFromPath(i);break}}Ze(s,o)})}function tn(){for(const e of I)e.destruct();I=[],[...document.querySelector("#one-d + .solutions").children].forEach(e=>{e.classList.contains("not-solution")||(e.querySelector(".score").textContent="0",e.querySelector(":scope > ol").innerHTML="")})}const J="settings1D",en={swatchAmount:44,swatchSizePx:30},F=new W("swatches-"+J,en),D=new Xt(document.querySelector("form#"+J)),Rt=D.form.elements,tt={swatchAmount:Rt.namedItem(J+"-swatch-amount"),swatchSizePx:Rt.namedItem(J+"-swatch-size")};function Qt(){for(const t of Object.keys(tt))tt[t].value=String(F.value[t])}function Zt(){F.set("swatchAmount",+tt.swatchAmount.value),F.set("swatchSizePx",+tt.swatchSizePx.value)}function Jt(){tn(),document.documentElement.style.setProperty("--swatch-size-1D",F.value.swatchSizePx+"px");const t=At(F.value.swatchAmount);Je(t)}Qt();requestAnimationFrame(()=>requestAnimationFrame(Jt));D.form.addEventListener("submit",t=>{t.target instanceof HTMLFormElement&&(t.preventDefault(),Zt(),Jt())});const nn=D.form.querySelector('.actions button[name="settings-update"]');nn.addEventListener("click",()=>{Zt(),document.documentElement.style.setProperty("--swatch-size-1D",F.value.swatchSizePx+"px")});const sn=D.form.querySelector('.actions button[name="settings-reset"]');sn.addEventListener("click",()=>{F.reset(),Qt()});D.addValidator({name:"settings-swatch-amount",method:t=>+t.value>=1&&+t.value<=999,message:"Should be between 1 and 999"});D.addValidator({name:"settings-swatch-size",method:t=>+t.value>=1&&+t.value<=3200,message:"Should be between 1 and 3200 pixels"});class R{values;N;stride;distMatrix;path;workers=[];destructed=!1;constructor(e,n,s=1,r=Ht){this.values=e.slice(),this.N=this.values.length,this.stride=n,this.path=this.values.map((o,a)=>a),this.distMatrix=this.createDistMatrix(s,r)}static async awaitWorker(e){const n=await new Promise((s,r)=>{const o=i=>{e.removeEventListener("message",o),s(i.data)},a=i=>{e.removeEventListener("error",a),r(i)};e.addEventListener("message",o),e.addEventListener("error",a)});return e.terminate(),n}getNeighbors(e){const n=[];return e%this.stride<this.stride-1&&e+1<this.N&&n.push(e+1),e+this.stride<this.N&&n.push(e+this.stride),n}createDistMatrix(e,n){const s=this.values,r=this.N,o=Array(r).fill(0).map(()=>Array(r).fill(0));for(let a=0;a<r;a++)for(let i=a+1;i<r;i++){const c=Math.pow(n(s[a],s[i]),e);o[a][i]=c,o[i][a]=c}return o}totalDist(){const e=this.distMatrix;let n=0;for(let s=0;s<this.N;s++){const r=this.getNeighbors(s);for(const o of r)n+=e[this.path[s]][this.path[o]]}return n}straightPath(){this.path=this.values.map((e,n)=>n)}async snakePath(e=0){if(this.destructed)return;const n=new Worker(new URL("/SortingSwatchesResearch/assets/snake-C0hlRefn.js",import.meta.url),{type:"module"});this.workers.push(n),n.postMessage({N:this.N,stride:this.stride,distMatrix:this.distMatrix,startIndex:e}),this.path=await R.awaitWorker(n)}async greedyPath(e=0){if(this.destructed)return;const n=new Worker(new URL("/SortingSwatchesResearch/assets/greedy-Bkqz6gSn.js",import.meta.url),{type:"module"});this.workers.push(n),n.postMessage({N:this.N,stride:this.stride,distMatrix:this.distMatrix,startIndex:e}),this.path=await R.awaitWorker(n)}async twoOpt(e=1e8/this.N**2){if(this.destructed)return;const n=new Worker(new URL("/SortingSwatchesResearch/assets/twoOpt-B6rWj06p.js",import.meta.url),{type:"module"});this.workers.push(n),n.postMessage({N:this.N,stride:this.stride,path:this.path,distMatrix:this.distMatrix,maxImprovements:e}),this.path=await R.awaitWorker(n)}getValuesFromPath(e=this.path){return this.values=(e||this.path).map(n=>this.values[n])}terminateWorkers(){for(const e of this.workers)e.terminate();this.workers=[]}destruct(){this.terminateWorkers(),this.destructed=!0}}class v{order;constructor(e){this.order=e}indexToPoint(e){if(!Number.isInteger(e))throw new Error("Index must be an integer");if(e<0)throw new Error("Index represents a position in an array and must be positive");const n=2**this.order,s=n**2;if(e>=s)throw new Error("The index is above the supported amount of space the current order support. Reduce the index or increase the order.");const r={x:0,y:0};let o,a,i=1,c=e;for(;i<n;)o=v.getRx(c),a=v.getRy(c,o),v.rotatePoint(r,o,a,i),v.movePoint(r,o,a,i),c=Math.trunc(c/4),i=i*2;return r}static getRx(e){if(e<0)throw new Error("Index must be above 0");return 1&Math.trunc(e/2)}static getRy(e,n){if(e<0)throw new Error("Index must be above 0");return 1&(e^n)}static movePoint(e,n,s,r){e.x+=r*n,e.y+=r*s}pointToIndex(e){const n=2**this.order;if(e.x>=n||e.y>=n)throw new Error("The point must be in range with the order");let s,r,o=0;for(let a=n/2;a>0;a=Math.floor(a/2))s=v.getRxFromPoint(e,a),r=v.getRyFromPoint(e,a),o+=v.getNewIndexFromRows(a,s,r),v.rotatePoint(e,s,r,n);return o}static getNewIndexFromRows(e,n,s){return e*e*(3*n^s)}static getRxFromPoint(e,n){return v.getPointValueFromNumber(e.x,n)}static getRyFromPoint(e,n){return v.getPointValueFromNumber(e.y,n)}static getPointValueFromNumber(e,n){return(e&n)>0?1:0}static rotatePoint(e,n,s,r){if(s===0){if(n===1){if(e.x=r-1-e.x,e.y=r-1-e.y,e.x<0)throw Error("Number of columns must be at leat 1 above x");if(e.y<0)throw Error("Number of columns must be at leat 1 above y")}[e.x,e.y]=[e.y,e.x]}}offsetPoint(e,n){if(n<0)throw new Error("Projecting a point must be on a positive width");const s=Math.pow(2,this.order),r=n/s;return{x:e.x*r+r/2,y:e.y*r+r/2}}deoffsetPoint(e,n){if(n<0)throw new Error("Projecting a point must be on a positive width");const s=Math.pow(2,this.order),r=n/s;return{x:Math.trunc(e.x/r),y:Math.trunc(e.y/r)}}}function rn(t,e,n){const s=Math.floor(1/Qe(e,n,3));t.querySelector(".score").textContent=String(s);const r=t.querySelector("ol");if(r){r.innerHTML="";for(let o=0;o<e.length;o+=n){const a=document.createElement("li"),i=document.createElement("ol");for(let c=o;c<o+n&&c<e.length;c++){const[u,h,l]=e[c],g=document.createElement("li");g.style.backgroundColor=`rgb(${u}, ${h}, ${l})`,i.appendChild(g)}a.appendChild(i),r.appendChild(a)}}}function on(t,e){const n=Math.ceil(t.length/e);for(let s=0;s<n;++s){if(!(s%2))continue;const r=s*e,o=Math.min(r+e,t.length);let a=r,i=o-1;for(;a<i;){const c=t[a];t[a]=t[i],t[i]=c,++a,--i}}}let P=[];function an(t,e){const n=[...document.querySelector("#two-d + .solutions").children],s=t.length,r=Math.ceil(s/e),o=Math.ceil(Math.log2(Math.max(e,r))),a=new v(o),i=[];for(let c=0;c<r;++c)for(let u=0;u<e;++u){const h=a.pointToIndex({x:u,y:c});h<s&&i.push(h)}n.forEach(async(c,u)=>{if(c.classList.contains("not-solution"))return;let h=structuredClone(t);switch(u){case 0:case 1:break;case 2:{if(s<=1)break;const l=new _(h,3);P.push(l);let g=[],d=1/0;for(let m=0;m<Math.min(s,6);m++){await l.nearestNeighborPath(m),await l.twoOpt();const p=l.totalDist();p<d&&(d=p,g=l.path)}h=l.getValuesFromPath(g);break}case 3:{if(s<=1)break;const l=new _(h,3);P.push(l);let g=[],d=1/0;for(let m=0;m<Math.min(s,6);m++){await l.nearestNeighborPath(m),await l.twoOpt();const p=l.totalDist();p<d&&(d=p,g=l.path)}on(g,e),h=l.getValuesFromPath(g);break}case 4:{if(s<=1)break;const l=new _(h,3);P.push(l);let g=[],d=1/0;for(let m=0;m<Math.min(s,6);m++){await l.nearestNeighborPath(m),await l.twoOpt();const p=l.totalDist();p<d&&(d=p,g=l.path)}g=i.map(m=>g[m]),h=l.getValuesFromPath(g);break}case 5:{if(s<=1)break;const l=new R(h,e,2);P.push(l),await l.twoOpt(1e7/l.N),h=l.getValuesFromPath();break}case 6:{if(s<=1)break;const l=new _(h,3);P.push(l);let g=[],d=1/0;for(let p=0;p<Math.min(s,6);p++){await l.nearestNeighborPath(p),await l.twoOpt();const y=l.totalDist();y<d&&(d=y,g=l.path)}g=i.map(p=>g[p]),h=l.getValuesFromPath(g);const m=new R(h,e,2);P.push(m),await m.twoOpt(1e8/m.N),h=m.getValuesFromPath();break}case 7:{if(s<=1)break;const l=new R(h,e,2);P.push(l);let g=[],d=1/0;for(let m=0;m<Math.min(s,6);m++){await l.snakePath(m),await l.twoOpt(1e9/l.N**2);const p=l.totalDist();p<d&&(d=p,g=l.path)}h=l.getValuesFromPath(g);break}case 8:{if(s<=1)break;const l=new R(h,e,2);P.push(l);let g=[],d=1/0;for(let m=0;m<Math.min(s,2);m++){await l.greedyPath(m),await l.twoOpt(6e9/l.N**2);const p=l.totalDist();p<d&&(d=p,g=l.path)}h=l.getValuesFromPath(g);break}}rn(c,h,e)})}function cn(){for(const e of P)e.destruct();P=[],[...document.querySelector("#two-d + .solutions").children].forEach(e=>{e.classList.contains("not-solution")||(e.querySelector(".score").textContent="0",e.querySelector(":scope > ol").innerHTML="")})}const j="settings2D",ln={swatchAmountX:30,swatchAmountY:30,swatchSizePx:20},S=new W("swatches-"+j,ln),V=new Xt(document.querySelector("form#"+j)),ut=V.form.elements,L={swatchAmountX:ut.namedItem(j+"-swatch-amount-x"),swatchAmountY:ut.namedItem(j+"-swatch-amount-y"),swatchSizePx:ut.namedItem(j+"-swatch-size")};function te(){for(const t of Object.keys(L))L[t].value=String(S.value[t])}function ee(){S.set("swatchAmountX",+L.swatchAmountX.value),S.set("swatchAmountY",+L.swatchAmountY.value),S.set("swatchSizePx",+L.swatchSizePx.value)}function ne(){cn(),document.documentElement.style.setProperty("--swatch-size-2D",S.value.swatchSizePx+"px");const t=At(S.value.swatchAmountX*S.value.swatchAmountY);an(t,S.value.swatchAmountX)}te();requestAnimationFrame(()=>requestAnimationFrame(ne));V.form.addEventListener("submit",t=>{t.target instanceof HTMLFormElement&&(t.preventDefault(),ee(),ne())});const un=V.form.querySelector('.actions button[name="settings-update"]');un.addEventListener("click",()=>{ee(),document.documentElement.style.setProperty("--swatch-size-2D",S.value.swatchSizePx+"px")});const hn=V.form.querySelector('.actions button[name="settings-reset"]');hn.addEventListener("click",()=>{S.reset(),te()});V.addValidator({name:"settings-swatch-amount-x",method:t=>+t.value>=1&&+t.value*+L.swatchAmountY.value<1e3,message:"Total amount of swatches should be between 1 and 999"});V.addValidator({name:"settings-swatch-amount-x",method:t=>+t.value>=1&&+t.value*+L.swatchAmountX.value<1e3,message:"Total amount of swatches should be between 1 and 999"});V.addValidator({name:"settings-swatch-size",method:t=>+t.value>=1&&+t.value<=3200,message:"Should be between 1 and 3200 pixels"});
