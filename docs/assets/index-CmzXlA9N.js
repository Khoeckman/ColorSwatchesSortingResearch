(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();const ot=t=>1/(1+Math.exp(-t*6+3)),At=t=>new Array(t).fill(0).map(()=>[~~(ot(Math.random())*256),~~(ot(Math.random())*256),~~(ot(Math.random())*256)]);class ie{constructor(){this.keyToValue=new Map,this.valueToKey=new Map}set(e,n){this.keyToValue.set(e,n),this.valueToKey.set(n,e)}getByKey(e){return this.keyToValue.get(e)}getByValue(e){return this.valueToKey.get(e)}clear(){this.keyToValue.clear(),this.valueToKey.clear()}}class Nt{constructor(e){this.generateIdentifier=e,this.kv=new ie}register(e,n){this.kv.getByValue(e)||(n||(n=this.generateIdentifier(e)),this.kv.set(n,e))}clear(){this.kv.clear()}getIdentifier(e){return this.kv.getByValue(e)}getValue(e){return this.kv.getByKey(e)}}class ce extends Nt{constructor(){super(e=>e.name),this.classToAllowedProps=new Map}register(e,n){typeof n=="object"?(n.allowProps&&this.classToAllowedProps.set(e,n.allowProps),super.register(e,n.identifier)):super.register(e,n)}getAllowedProps(e){return this.classToAllowedProps.get(e)}}function le(t){if("values"in Object)return Object.values(t);const e=[];for(const n in t)t.hasOwnProperty(n)&&e.push(t[n]);return e}function ue(t,e){const n=le(t);if("find"in n)return n.find(e);const s=n;for(let r=0;r<s.length;r++){const o=s[r];if(e(o))return o}}function z(t,e){Object.entries(t).forEach(([n,s])=>e(s,n))}function X(t,e){return t.indexOf(e)!==-1}function vt(t,e){for(let n=0;n<t.length;n++){const s=t[n];if(e(s))return s}}class he{constructor(){this.transfomers={}}register(e){this.transfomers[e.name]=e}findApplicable(e){return ue(this.transfomers,n=>n.isApplicable(e))}findByName(e){return this.transfomers[e]}}const fe=t=>Object.prototype.toString.call(t).slice(8,-1),It=t=>typeof t>"u",de=t=>t===null,D=t=>typeof t!="object"||t===null||t===Object.prototype?!1:Object.getPrototypeOf(t)===null?!0:Object.getPrototypeOf(t)===Object.prototype,ct=t=>D(t)&&Object.keys(t).length===0,A=t=>Array.isArray(t),me=t=>typeof t=="string",ge=t=>typeof t=="number"&&!isNaN(t),pe=t=>typeof t=="boolean",be=t=>t instanceof RegExp,B=t=>t instanceof Map,j=t=>t instanceof Set,Ot=t=>fe(t)==="Symbol",ye=t=>t instanceof Date&&!isNaN(t.valueOf()),Rt=t=>t instanceof Error,kt=t=>typeof t=="number"&&isNaN(t),we=t=>pe(t)||de(t)||It(t)||ge(t)||me(t)||Ot(t),_e=t=>typeof t=="bigint",ve=t=>t===1/0||t===-1/0,ke=t=>ArrayBuffer.isView(t)&&!(t instanceof DataView),Me=t=>t instanceof URL,lt=t=>t.replace(/\\/g,"\\\\").replace(/\./g,"\\."),at=t=>t.map(String).map(lt).join("."),F=(t,e)=>{const n=[];let s="";for(let o=0;o<t.length;o++){let a=t.charAt(o);if(!e&&a==="\\"){const l=t.charAt(o+1);if(l==="\\"){s+="\\",o++;continue}else if(l!==".")throw Error("invalid path")}if(a==="\\"&&t.charAt(o+1)==="."){s+=".",o++;continue}if(a==="."){n.push(s),s="";continue}s+=a}const r=s;return n.push(r),n};function k(t,e,n,s){return{isApplicable:t,annotation:e,transform:n,untransform:s}}const Lt=[k(It,"undefined",()=>null,()=>{}),k(_e,"bigint",t=>t.toString(),t=>typeof BigInt<"u"?BigInt(t):(console.error("Please add a BigInt polyfill."),t)),k(ye,"Date",t=>t.toISOString(),t=>new Date(t)),k(Rt,"Error",(t,e)=>{const n={name:t.name,message:t.message};return"cause"in t&&(n.cause=t.cause),e.allowedErrorProps.forEach(s=>{n[s]=t[s]}),n},(t,e)=>{const n=new Error(t.message,{cause:t.cause});return n.name=t.name,n.stack=t.stack,e.allowedErrorProps.forEach(s=>{n[s]=t[s]}),n}),k(be,"regexp",t=>""+t,t=>{const e=t.slice(1,t.lastIndexOf("/")),n=t.slice(t.lastIndexOf("/")+1);return new RegExp(e,n)}),k(j,"set",t=>[...t.values()],t=>new Set(t)),k(B,"map",t=>[...t.entries()],t=>new Map(t)),k(t=>kt(t)||ve(t),"number",t=>kt(t)?"NaN":t>0?"Infinity":"-Infinity",Number),k(t=>t===0&&1/t===-1/0,"number",()=>"-0",Number),k(Me,"URL",t=>t.toString(),t=>new URL(t))];function Z(t,e,n,s){return{isApplicable:t,annotation:e,transform:n,untransform:s}}const Vt=Z((t,e)=>Ot(t)?!!e.symbolRegistry.getIdentifier(t):!1,(t,e)=>["symbol",e.symbolRegistry.getIdentifier(t)],t=>t.description,(t,e,n)=>{const s=n.symbolRegistry.getValue(e[1]);if(!s)throw new Error("Trying to deserialize unknown symbol");return s}),Se=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,Uint8ClampedArray].reduce((t,e)=>(t[e.name]=e,t),{}),qt=Z(ke,t=>["typed-array",t.constructor.name],t=>[...t],(t,e)=>{const n=Se[e[1]];if(!n)throw new Error("Trying to deserialize unknown typed array");return new n(t)});function zt(t,e){return t?.constructor?!!e.classRegistry.getIdentifier(t.constructor):!1}const Tt=Z(zt,(t,e)=>["class",e.classRegistry.getIdentifier(t.constructor)],(t,e)=>{const n=e.classRegistry.getAllowedProps(t.constructor);if(!n)return{...t};const s={};return n.forEach(r=>{s[r]=t[r]}),s},(t,e,n)=>{const s=n.classRegistry.getValue(e[1]);if(!s)throw new Error(`Trying to deserialize unknown class '${e[1]}' - check https://github.com/blitz-js/superjson/issues/116#issuecomment-773996564`);return Object.assign(Object.create(s.prototype),t)}),Ft=Z((t,e)=>!!e.customTransformerRegistry.findApplicable(t),(t,e)=>["custom",e.customTransformerRegistry.findApplicable(t).name],(t,e)=>e.customTransformerRegistry.findApplicable(t).serialize(t),(t,e,n)=>{const s=n.customTransformerRegistry.findByName(e[1]);if(!s)throw new Error("Trying to deserialize unknown custom value");return s.deserialize(t)}),Ee=[Tt,Vt,Ft,qt],Mt=(t,e)=>{const n=vt(Ee,r=>r.isApplicable(t,e));if(n)return{value:n.transform(t,e),type:n.annotation(t,e)};const s=vt(Lt,r=>r.isApplicable(t,e));if(s)return{value:s.transform(t,e),type:s.annotation}},Ct={};Lt.forEach(t=>{Ct[t.annotation]=t});const Pe=(t,e,n)=>{if(A(e))switch(e[0]){case"symbol":return Vt.untransform(t,e,n);case"class":return Tt.untransform(t,e,n);case"custom":return Ft.untransform(t,e,n);case"typed-array":return qt.untransform(t,e,n);default:throw new Error("Unknown transformation: "+e)}else{const s=Ct[e];if(!s)throw new Error("Unknown transformation: "+e);return s.untransform(t,n)}},L=(t,e)=>{if(e>t.size)throw new Error("index out of bounds");const n=t.keys();for(;e>0;)n.next(),e--;return n.next().value};function Dt(t){if(X(t,"__proto__"))throw new Error("__proto__ is not allowed as a property");if(X(t,"prototype"))throw new Error("prototype is not allowed as a property");if(X(t,"constructor"))throw new Error("constructor is not allowed as a property")}const xe=(t,e)=>{Dt(e);for(let n=0;n<e.length;n++){const s=e[n];if(j(t))t=L(t,+s);else if(B(t)){const r=+s,o=+e[++n]==0?"key":"value",a=L(t,r);switch(o){case"key":t=a;break;case"value":t=t.get(a);break}}else t=t[s]}return t},ut=(t,e,n)=>{if(Dt(e),e.length===0)return n(t);let s=t;for(let o=0;o<e.length-1;o++){const a=e[o];if(A(s)){const i=+a;s=s[i]}else if(D(s))s=s[a];else if(j(s)){const i=+a;s=L(s,i)}else if(B(s)){if(o===e.length-2)break;const c=+a,l=+e[++o]==0?"key":"value",h=L(s,c);switch(l){case"key":s=h;break;case"value":s=s.get(h);break}}}const r=e[e.length-1];if(A(s)?s[+r]=n(s[+r]):D(s)&&(s[r]=n(s[r])),j(s)){const o=L(s,+r),a=n(o);o!==a&&(s.delete(o),s.add(a))}if(B(s)){const o=+e[e.length-2],a=L(s,o);switch(+r==0?"key":"value"){case"key":{const c=n(a);s.set(c,s.get(a)),c!==a&&s.delete(a);break}case"value":{s.set(a,n(s.get(a)));break}}}return t},Bt=t=>t<1;function ht(t,e,n,s=[]){if(!t)return;const r=Bt(n);if(!A(t)){z(t,(i,c)=>ht(i,e,n,[...s,...F(c,r)]));return}const[o,a]=t;a&&z(a,(i,c)=>{ht(i,e,n,[...s,...F(c,r)])}),e(o,s)}function Ae(t,e,n,s){return ht(e,(r,o)=>{t=ut(t,o,a=>Pe(a,r,s))},n),t}function Ne(t,e,n){const s=Bt(n);function r(o,a){const i=xe(t,F(a,s));o.map(c=>F(c,s)).forEach(c=>{t=ut(t,c,()=>i)})}if(A(e)){const[o,a]=e;o.forEach(i=>{t=ut(t,F(i,s),()=>t)}),a&&z(a,r)}else z(e,r);return t}const Ie=(t,e)=>D(t)||A(t)||B(t)||j(t)||Rt(t)||zt(t,e);function Oe(t,e,n){const s=n.get(t);s?s.push(e):n.set(t,[e])}function Re(t,e){const n={};let s;return t.forEach(r=>{if(r.length<=1)return;e||(r=r.map(i=>i.map(String)).sort((i,c)=>i.length-c.length));const[o,...a]=r;o.length===0?s=a.map(at):n[at(o)]=a.map(at)}),s?ct(n)?[s]:[s,n]:ct(n)?void 0:n}const jt=(t,e,n,s,r=[],o=[],a=new Map)=>{const i=we(t);if(!i){Oe(t,r,e);const d=a.get(t);if(d)return s?{transformedValue:null}:d}if(!Ie(t,n)){const d=Mt(t,n),p=d?{transformedValue:d.value,annotations:[d.type]}:{transformedValue:t};return i||a.set(t,p),p}if(X(o,t))return{transformedValue:null};const c=Mt(t,n),l=c?.value??t,h=A(l)?[]:{},f={};z(l,(d,p)=>{if(p==="__proto__"||p==="constructor"||p==="prototype")throw new Error(`Detected property ${p}. This is a prototype pollution risk, please remove it from your object.`);const b=jt(d,e,n,s,[...r,p],[...o,t],a);h[p]=b.transformedValue,A(b.annotations)?f[lt(p)]=b.annotations:D(b.annotations)&&z(b.annotations,(w,v)=>{f[lt(p)+"."+v]=w})});const g=ct(f)?{transformedValue:h,annotations:c?[c.type]:void 0}:{transformedValue:h,annotations:c?[c.type,f]:f};return i||a.set(t,g),g};function $t(t){return Object.prototype.toString.call(t).slice(8,-1)}function St(t){return $t(t)==="Array"}function Le(t){if($t(t)!=="Object")return!1;const e=Object.getPrototypeOf(t);return!!e&&e.constructor===Object&&e===Object.prototype}function Ve(t,e,n,s,r){const o={}.propertyIsEnumerable.call(s,e)?"enumerable":"nonenumerable";o==="enumerable"&&(t[e]=n),r&&o==="nonenumerable"&&Object.defineProperty(t,e,{value:n,enumerable:!1,writable:!0,configurable:!0})}function ft(t,e={}){if(St(t))return t.map(r=>ft(r,e));if(!Le(t))return t;const n=Object.getOwnPropertyNames(t),s=Object.getOwnPropertySymbols(t);return[...n,...s].reduce((r,o)=>{if(o==="__proto__"||St(e.props)&&!e.props.includes(o))return r;const a=t[o],i=ft(a,e);return Ve(r,o,i,t,e.nonenumerable),r},{})}class m{constructor({dedupe:e=!1}={}){this.classRegistry=new ce,this.symbolRegistry=new Nt(n=>n.description??""),this.customTransformerRegistry=new he,this.allowedErrorProps=[],this.dedupe=e}serialize(e){const n=new Map,s=jt(e,n,this,this.dedupe),r={json:s.transformedValue};s.annotations&&(r.meta={...r.meta,values:s.annotations});const o=Re(n,this.dedupe);return o&&(r.meta={...r.meta,referentialEqualities:o}),r.meta&&(r.meta.v=1),r}deserialize(e,n){const{json:s,meta:r}=e;let o=n?.inPlace?s:ft(s);return r?.values&&(o=Ae(o,r.values,r.v??0,this)),r?.referentialEqualities&&(o=Ne(o,r.referentialEqualities,r.v??0)),o}stringify(e){return JSON.stringify(this.serialize(e))}parse(e){return this.deserialize(JSON.parse(e),{inPlace:!0})}registerClass(e,n){this.classRegistry.register(e,n)}registerSymbol(e,n){this.symbolRegistry.register(e,n)}registerCustom(e,n){this.customTransformerRegistry.register({name:n,...e})}allowErrorProps(...e){this.allowedErrorProps.push(...e)}}m.defaultInstance=new m;m.serialize=m.defaultInstance.serialize.bind(m.defaultInstance);m.deserialize=m.defaultInstance.deserialize.bind(m.defaultInstance);m.stringify=m.defaultInstance.stringify.bind(m.defaultInstance);m.parse=m.defaultInstance.parse.bind(m.defaultInstance);m.registerClass=m.defaultInstance.registerClass.bind(m.defaultInstance);m.registerSymbol=m.defaultInstance.registerSymbol.bind(m.defaultInstance);m.registerCustom=m.defaultInstance.registerCustom.bind(m.defaultInstance);m.allowErrorProps=m.defaultInstance.allowErrorProps.bind(m.defaultInstance);m.serialize;m.deserialize;m.stringify;m.parse;m.registerClass;m.registerCustom;m.registerSymbol;m.allowErrorProps;class ${static version="6.0.4";static superjson=m;itemName;defaultValue;#e;#n;storage;#t;constructor(e,n,s={}){const{encodeFn:r,decodeFn:o,storage:a=window.localStorage}=s;if(typeof e!="string")throw new TypeError("itemName is not a string");if(this.itemName=e,this.defaultValue=n,r&&typeof r!="function")throw new TypeError("encodeFn is defined but is not a function");if(this.#e=r||(i=>$.superjson.stringify(i)),o&&typeof o!="function")throw new TypeError("decodeFn is defined but is not a function");if(this.#n=o||(i=>$.superjson.parse(i)),!(a instanceof Storage))throw new TypeError("storage must be an instance of Storage");this.storage=a,this.sync()}set value(e){this.#t=e,this.storage.setItem(this.itemName,this.#e(e))}get value(){return this.#t}set(e,n){return typeof e=="function"?this.value=e(this.#t):this.value={...this.#t,[e]:n}}sync(e=this.#n){let n=this.storage.getItem(this.itemName);if(typeof n!="string")return this.reset();try{return this.value=e(n)}catch(s){return console.error(s),this.reset(),s}}reset(){return this.value=this.defaultValue}isDefault(){return this.#t===this.defaultValue}}class Ut{errors=[];validators=[];form;constructor(e){this.form=e,this.resetSummary(),this.form.addEventListener("submit",n=>this.onSubmit(n))}onLoad(){this.resetSummary(),this.removeInlineErrors()}onSubmit(e){this.onLoad(),this.validate()||(e.preventDefault(),e.stopImmediatePropagation(),this.showSummary(),this.showInlineErrors())}validate(){return this.validators.forEach(e=>{if(!e.method(e.field)){if(this.errors.map(n=>n.name).includes(e.name))return;this.errors.push(e)}}),this.errors.length===0}addValidator(e){const n=this.form.elements.namedItem(e.name);n&&this.validators.push({field:n,...e})}createInlineError(e){const n=document.createElement("span");return n.classList.add("field-error"),n.innerText=e.message,n.setAttribute("id",e.name+"-error"),n}showInlineErrors(){this.errors.forEach(e=>{const n=this.createInlineError(e),s=e.field;if(s instanceof Element){if(s.classList.add("invalid"),s.setAttribute("aria-invalid","true"),!("labels"in s&&s.labels instanceof NodeList))return;const r=s.labels[0];r.insertBefore(n,r.lastElementChild)}else s instanceof RadioNodeList&&s.forEach(r=>{r.classList.add("invalid"),r.setAttribute("aria-describedby",n.id),r.setAttribute("aria-invalid","true");const a=s[0].closest("fieldset")?.querySelector("legend");a&&a.appendChild(n)})})}removeInlineErrors(){this.form.querySelectorAll(".field-error").forEach(e=>e.remove()),this.form.querySelectorAll(".invalid").forEach(e=>{e.removeAttribute("aria-describedby"),e.removeAttribute("aria-invalid"),e.classList.remove("invalid")}),this.errors=[]}resetSummary(){const e=this.form.querySelector(".error-summary");e&&(e.style.display="none",e.querySelector("ul").innerHTML="")}showSummary(){const e=this.form.querySelector(".error-summary");if(!e)return;const n=e.querySelector("ul");n&&(this.errors.forEach(s=>{const r=document.createElement("a");r.href="#"+s.name,r.innerText=s.message,r.addEventListener("click",a=>{a.preventDefault();const i=a.currentTarget;if(!i)return;const c=i.getAttribute("href");if(!c)return;const l=document.querySelector(c);l&&(l.focus(),l.scrollIntoView({behavior:"smooth",block:"center"}))});const o=document.createElement("li");o.appendChild(r),n.appendChild(o)}),e.tabIndex=-1,e.style.display="block",e.focus())}}const dt={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};for(const t in dt)Object.freeze(dt[t]);const U=Object.freeze(dt),Kt={};for(const t of Object.keys(U))Kt[U[t]]=t;const u={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},oklab:{channels:3,labels:["okl","oka","okb"]},lch:{channels:3,labels:"lch"},oklch:{channels:3,labels:["okl","okc","okh"]},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}},E=(6/29)**3;function V(t){const e=t>.0031308?1.055*t**.4166666666666667-.055:t*12.92;return Math.min(Math.max(0,e),1)}function q(t){return t>.04045?((t+.055)/1.055)**2.4:t/12.92}for(const t of Object.keys(u)){if(!("channels"in u[t]))throw new Error("missing channels property: "+t);if(!("labels"in u[t]))throw new Error("missing channel labels property: "+t);if(u[t].labels.length!==u[t].channels)throw new Error("channel and label counts mismatch: "+t);const{channels:e,labels:n}=u[t];delete u[t].channels,delete u[t].labels,Object.defineProperty(u[t],"channels",{value:e}),Object.defineProperty(u[t],"labels",{value:n})}u.rgb.hsl=function(t){const e=t[0]/255,n=t[1]/255,s=t[2]/255,r=Math.min(e,n,s),o=Math.max(e,n,s),a=o-r;let i,c;switch(o){case r:{i=0;break}case e:{i=(n-s)/a;break}case n:{i=2+(s-e)/a;break}case s:{i=4+(e-n)/a;break}}i=Math.min(i*60,360),i<0&&(i+=360);const l=(r+o)/2;return o===r?c=0:l<=.5?c=a/(o+r):c=a/(2-o-r),[i,c*100,l*100]};u.rgb.hsv=function(t){let e,n,s,r,o;const a=t[0]/255,i=t[1]/255,c=t[2]/255,l=Math.max(a,i,c),h=l-Math.min(a,i,c),f=function(g){return(l-g)/6/h+1/2};if(h===0)r=0,o=0;else{switch(o=h/l,e=f(a),n=f(i),s=f(c),l){case a:{r=s-n;break}case i:{r=1/3+e-s;break}case c:{r=2/3+n-e;break}}r<0?r+=1:r>1&&(r-=1)}return[r*360,o*100,l*100]};u.rgb.hwb=function(t){const e=t[0],n=t[1];let s=t[2];const r=u.rgb.hsl(t)[0],o=1/255*Math.min(e,Math.min(n,s));return s=1-1/255*Math.max(e,Math.max(n,s)),[r,o*100,s*100]};u.rgb.oklab=function(t){const e=q(t[0]/255),n=q(t[1]/255),s=q(t[2]/255),r=Math.cbrt(.4122214708*e+.5363325363*n+.0514459929*s),o=Math.cbrt(.2119034982*e+.6806995451*n+.1073969566*s),a=Math.cbrt(.0883024619*e+.2817188376*n+.6299787005*s),i=.2104542553*r+.793617785*o-.0040720468*a,c=1.9779984951*r-2.428592205*o+.4505937099*a,l=.0259040371*r+.7827717662*o-.808675766*a;return[i*100,c*100,l*100]};u.rgb.cmyk=function(t){const e=t[0]/255,n=t[1]/255,s=t[2]/255,r=Math.min(1-e,1-n,1-s),o=(1-e-r)/(1-r)||0,a=(1-n-r)/(1-r)||0,i=(1-s-r)/(1-r)||0;return[o*100,a*100,i*100,r*100]};function qe(t,e){return(t[0]-e[0])**2+(t[1]-e[1])**2+(t[2]-e[2])**2}u.rgb.keyword=function(t){const e=Kt[t];if(e)return e;let n=Number.POSITIVE_INFINITY,s;for(const r of Object.keys(U)){const o=U[r],a=qe(t,o);a<n&&(n=a,s=r)}return s};u.keyword.rgb=function(t){return[...U[t]]};u.rgb.xyz=function(t){const e=q(t[0]/255),n=q(t[1]/255),s=q(t[2]/255),r=e*.4124564+n*.3575761+s*.1804375,o=e*.2126729+n*.7151522+s*.072175,a=e*.0193339+n*.119192+s*.9503041;return[r*100,o*100,a*100]};u.rgb.lab=function(t){const e=u.rgb.xyz(t);let n=e[0],s=e[1],r=e[2];n/=95.047,s/=100,r/=108.883,n=n>E?n**(1/3):7.787*n+16/116,s=s>E?s**(1/3):7.787*s+16/116,r=r>E?r**(1/3):7.787*r+16/116;const o=116*s-16,a=500*(n-s),i=200*(s-r);return[o,a,i]};u.hsl.rgb=function(t){const e=t[0]/360,n=t[1]/100,s=t[2]/100;let r,o;if(n===0)return o=s*255,[o,o,o];const a=s<.5?s*(1+n):s+n-s*n,i=2*s-a,c=[0,0,0];for(let l=0;l<3;l++)r=e+1/3*-(l-1),r<0&&r++,r>1&&r--,6*r<1?o=i+(a-i)*6*r:2*r<1?o=a:3*r<2?o=i+(a-i)*(2/3-r)*6:o=i,c[l]=o*255;return c};u.hsl.hsv=function(t){const e=t[0];let n=t[1]/100,s=t[2]/100,r=n;const o=Math.max(s,.01);s*=2,n*=s<=1?s:2-s,r*=o<=1?o:2-o;const a=(s+n)/2,i=s===0?2*r/(o+r):2*n/(s+n);return[e,i*100,a*100]};u.hsv.rgb=function(t){const e=t[0]/60,n=t[1]/100;let s=t[2]/100;const r=Math.floor(e)%6,o=e-Math.floor(e),a=255*s*(1-n),i=255*s*(1-n*o),c=255*s*(1-n*(1-o));switch(s*=255,r){case 0:return[s,c,a];case 1:return[i,s,a];case 2:return[a,s,c];case 3:return[a,i,s];case 4:return[c,a,s];case 5:return[s,a,i]}};u.hsv.hsl=function(t){const e=t[0],n=t[1]/100,s=t[2]/100,r=Math.max(s,.01);let o,a;a=(2-n)*s;const i=(2-n)*r;return o=n*r,o/=i<=1?i:2-i,o=o||0,a/=2,[e,o*100,a*100]};u.hwb.rgb=function(t){const e=t[0]/360;let n=t[1]/100,s=t[2]/100;const r=n+s;let o;r>1&&(n/=r,s/=r);const a=Math.floor(6*e),i=1-s;o=6*e-a,(a&1)!==0&&(o=1-o);const c=n+o*(i-n);let l,h,f;switch(a){default:case 6:case 0:{l=i,h=c,f=n;break}case 1:{l=c,h=i,f=n;break}case 2:{l=n,h=i,f=c;break}case 3:{l=n,h=c,f=i;break}case 4:{l=c,h=n,f=i;break}case 5:{l=i,h=n,f=c;break}}return[l*255,h*255,f*255]};u.cmyk.rgb=function(t){const e=t[0]/100,n=t[1]/100,s=t[2]/100,r=t[3]/100,o=1-Math.min(1,e*(1-r)+r),a=1-Math.min(1,n*(1-r)+r),i=1-Math.min(1,s*(1-r)+r);return[o*255,a*255,i*255]};u.xyz.rgb=function(t){const e=t[0]/100,n=t[1]/100,s=t[2]/100;let r,o,a;return r=e*3.2404542+n*-1.5371385+s*-.4985314,o=e*-.969266+n*1.8760108+s*.041556,a=e*.0556434+n*-.2040259+s*1.0572252,r=V(r),o=V(o),a=V(a),[r*255,o*255,a*255]};u.xyz.lab=function(t){let e=t[0],n=t[1],s=t[2];e/=95.047,n/=100,s/=108.883,e=e>E?e**(1/3):7.787*e+16/116,n=n>E?n**(1/3):7.787*n+16/116,s=s>E?s**(1/3):7.787*s+16/116;const r=116*n-16,o=500*(e-n),a=200*(n-s);return[r,o,a]};u.xyz.oklab=function(t){const e=t[0]/100,n=t[1]/100,s=t[2]/100,r=Math.cbrt(.8189330101*e+.3618667424*n-.1288597137*s),o=Math.cbrt(.0329845436*e+.9293118715*n+.0361456387*s),a=Math.cbrt(.0482003018*e+.2643662691*n+.633851707*s),i=.2104542553*r+.793617785*o-.0040720468*a,c=1.9779984951*r-2.428592205*o+.4505937099*a,l=.0259040371*r+.7827717662*o-.808675766*a;return[i*100,c*100,l*100]};u.oklab.oklch=function(t){return u.lab.lch(t)};u.oklab.xyz=function(t){const e=t[0]/100,n=t[1]/100,s=t[2]/100,r=(.999999998*e+.396337792*n+.215803758*s)**3,o=(1.000000008*e-.105561342*n-.063854175*s)**3,a=(1.000000055*e-.089484182*n-1.291485538*s)**3,i=1.227013851*r-.55779998*o+.281256149*a,c=-.040580178*r+1.11225687*o-.071676679*a,l=-.076381285*r-.421481978*o+1.58616322*a;return[i*100,c*100,l*100]};u.oklab.rgb=function(t){const e=t[0]/100,n=t[1]/100,s=t[2]/100,r=(e+.3963377774*n+.2158037573*s)**3,o=(e-.1055613458*n-.0638541728*s)**3,a=(e-.0894841775*n-1.291485548*s)**3,i=V(4.0767416621*r-3.3077115913*o+.2309699292*a),c=V(-1.2684380046*r+2.6097574011*o-.3413193965*a),l=V(-.0041960863*r-.7034186147*o+1.707614701*a);return[i*255,c*255,l*255]};u.oklch.oklab=function(t){return u.lch.lab(t)};u.lab.xyz=function(t){const e=t[0],n=t[1],s=t[2];let r,o,a;o=(e+16)/116,r=n/500+o,a=o-s/200;const i=o**3,c=r**3,l=a**3;return o=i>E?i:(o-16/116)/7.787,r=c>E?c:(r-16/116)/7.787,a=l>E?l:(a-16/116)/7.787,r*=95.047,o*=100,a*=108.883,[r,o,a]};u.lab.lch=function(t){const e=t[0],n=t[1],s=t[2];let r;r=Math.atan2(s,n)*360/2/Math.PI,r<0&&(r+=360);const a=Math.sqrt(n*n+s*s);return[e,a,r]};u.lch.lab=function(t){const e=t[0],n=t[1],r=t[2]/360*2*Math.PI,o=n*Math.cos(r),a=n*Math.sin(r);return[e,o,a]};u.rgb.ansi16=function(t,e=null){const[n,s,r]=t;let o=e===null?u.rgb.hsv(t)[2]:e;if(o=Math.round(o/50),o===0)return 30;let a=30+(Math.round(r/255)<<2|Math.round(s/255)<<1|Math.round(n/255));return o===2&&(a+=60),a};u.hsv.ansi16=function(t){return u.rgb.ansi16(u.hsv.rgb(t),t[2])};u.rgb.ansi256=function(t){const e=t[0],n=t[1],s=t[2];return e>>4===n>>4&&n>>4===s>>4?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(n/255*5)+Math.round(s/255*5)};u.ansi16.rgb=function(t){t=t[0];let e=t%10;if(e===0||e===7)return t>50&&(e+=3.5),e=e/10.5*255,[e,e,e];const n=(Math.trunc(t>50)+1)*.5,s=(e&1)*n*255,r=(e>>1&1)*n*255,o=(e>>2&1)*n*255;return[s,r,o]};u.ansi256.rgb=function(t){if(t=t[0],t>=232){const o=(t-232)*10+8;return[o,o,o]}t-=16;let e;const n=Math.floor(t/36)/5*255,s=Math.floor((e=t%36)/6)/5*255,r=e%6/5*255;return[n,s,r]};u.rgb.hex=function(t){const n=(((Math.round(t[0])&255)<<16)+((Math.round(t[1])&255)<<8)+(Math.round(t[2])&255)).toString(16).toUpperCase();return"000000".slice(n.length)+n};u.hex.rgb=function(t){const e=t.toString(16).match(/[a-f\d]{6}|[a-f\d]{3}/i);if(!e)return[0,0,0];let n=e[0];e[0].length===3&&(n=[...n].map(i=>i+i).join(""));const s=Number.parseInt(n,16),r=s>>16&255,o=s>>8&255,a=s&255;return[r,o,a]};u.rgb.hcg=function(t){const e=t[0]/255,n=t[1]/255,s=t[2]/255,r=Math.max(Math.max(e,n),s),o=Math.min(Math.min(e,n),s),a=r-o;let i;const c=a<1?o/(1-a):0;return a<=0?i=0:r===e?i=(n-s)/a%6:r===n?i=2+(s-e)/a:i=4+(e-n)/a,i/=6,i%=1,[i*360,a*100,c*100]};u.hsl.hcg=function(t){const e=t[1]/100,n=t[2]/100,s=n<.5?2*e*n:2*e*(1-n);let r=0;return s<1&&(r=(n-.5*s)/(1-s)),[t[0],s*100,r*100]};u.hsv.hcg=function(t){const e=t[1]/100,n=t[2]/100,s=e*n;let r=0;return s<1&&(r=(n-s)/(1-s)),[t[0],s*100,r*100]};u.hcg.rgb=function(t){const e=t[0]/360,n=t[1]/100,s=t[2]/100;if(n===0)return[s*255,s*255,s*255];const r=[0,0,0],o=e%1*6,a=o%1,i=1-a;let c=0;switch(Math.floor(o)){case 0:{r[0]=1,r[1]=a,r[2]=0;break}case 1:{r[0]=i,r[1]=1,r[2]=0;break}case 2:{r[0]=0,r[1]=1,r[2]=a;break}case 3:{r[0]=0,r[1]=i,r[2]=1;break}case 4:{r[0]=a,r[1]=0,r[2]=1;break}default:r[0]=1,r[1]=0,r[2]=i}return c=(1-n)*s,[(n*r[0]+c)*255,(n*r[1]+c)*255,(n*r[2]+c)*255]};u.hcg.hsv=function(t){const e=t[1]/100,n=t[2]/100,s=e+n*(1-e);let r=0;return s>0&&(r=e/s),[t[0],r*100,s*100]};u.hcg.hsl=function(t){const e=t[1]/100,s=t[2]/100*(1-e)+.5*e;let r=0;return s>0&&s<.5?r=e/(2*s):s>=.5&&s<1&&(r=e/(2*(1-s))),[t[0],r*100,s*100]};u.hcg.hwb=function(t){const e=t[1]/100,n=t[2]/100,s=e+n*(1-e);return[t[0],(s-e)*100,(1-s)*100]};u.hwb.hcg=function(t){const e=t[1]/100,s=1-t[2]/100,r=s-e;let o=0;return r<1&&(o=(s-r)/(1-r)),[t[0],r*100,o*100]};u.apple.rgb=function(t){return[t[0]/65535*255,t[1]/65535*255,t[2]/65535*255]};u.rgb.apple=function(t){return[t[0]/255*65535,t[1]/255*65535,t[2]/255*65535]};u.gray.rgb=function(t){return[t[0]/100*255,t[0]/100*255,t[0]/100*255]};u.gray.hsl=function(t){return[0,0,t[0]]};u.gray.hsv=u.gray.hsl;u.gray.hwb=function(t){return[0,100,t[0]]};u.gray.cmyk=function(t){return[0,0,0,t[0]]};u.gray.lab=function(t){return[t[0],0,0]};u.gray.hex=function(t){const e=Math.round(t[0]/100*255)&255,s=((e<<16)+(e<<8)+e).toString(16).toUpperCase();return"000000".slice(s.length)+s};u.rgb.gray=function(t){return[(t[0]+t[1]+t[2])/3/255*100]};function ze(){const t={},e=Object.keys(u);for(let{length:n}=e,s=0;s<n;s++)t[e[s]]={distance:-1,parent:null};return t}function Te(t){const e=ze(),n=[t];for(e[t].distance=0;n.length>0;){const s=n.pop(),r=Object.keys(u[s]);for(let{length:o}=r,a=0;a<o;a++){const i=r[a],c=e[i];c.distance===-1&&(c.distance=e[s].distance+1,c.parent=s,n.unshift(i))}}return e}function Fe(t,e){return function(n){return e(t(n))}}function Ce(t,e){const n=[e[t].parent,t];let s=u[e[t].parent][t],r=e[t].parent;for(;e[r].parent;)n.unshift(e[r].parent),s=Fe(u[e[r].parent][r],s),r=e[r].parent;return s.conversion=n,s}function De(t){const e=Te(t),n={},s=Object.keys(e);for(let{length:r}=s,o=0;o<r;o++){const a=s[o];e[a].parent!==null&&(n[a]=Ce(a,e))}return n}const y={},Be=Object.keys(u);function je(t){const e=function(...n){const s=n[0];return s==null?s:(s.length>1&&(n=s),t(n))};return"conversion"in t&&(e.conversion=t.conversion),e}function $e(t){const e=function(...n){const s=n[0];if(s==null)return s;s.length>1&&(n=s);const r=t(n);if(typeof r=="object")for(let{length:o}=r,a=0;a<o;a++)r[a]=Math.round(r[a]);return r};return"conversion"in t&&(e.conversion=t.conversion),e}for(const t of Be){y[t]={},Object.defineProperty(y[t],"channels",{value:u[t].channels}),Object.defineProperty(y[t],"labels",{value:u[t].labels});const e=De(t),n=Object.keys(e);for(const s of n){const r=e[s];y[t][s]=$e(r),y[t][s].raw=je(r)}}const{atan2:Et,cos:H,exp:Ue,sin:Pt,sqrt:S,PI:P}=Math;function Wt([t,e,n],[s,r,o],a={}){const{lightness:i=1,chroma:c=1,hue:l=1}=a,h=s-t,f=n*n,g=o*o,d=S(e*e+f),p=S(r*r+g),b=(t+s)/2,v=((d+p)/2)**7,mt=.5*(1-S(v/(v+6103515625))),J=e+e*mt,tt=r+r*mt,K=S(J*J+f),W=S(tt*tt+g),et=(K+W)/2,te=W-K,nt=Et(n,J)/P*180,gt=Et(o,tt)/P*180;let pt=0,N=0;if(K===0||W===0)N=nt+gt;else{const _t=((gt-nt+540)%360-180)/2;pt=2*S(K*W)*Pt(_t/180*P),N=(nt+_t+360)%360}const ee=1+-.17*H((N-30)/180*P)+.24*H(2*N/180*P)+.32*H((3*N+6)/180*P)+-.2*H((4*N-63)/180*P),bt=(b-50)*(b-50),ne=1+.015*bt/S(20+bt),se=1+.045*et,re=1+.015*et*ee,yt=et**7,oe=2*S(yt/(yt+6103515625)),ae=-Pt(60*Ue(-(((N-275)/25)**2))/180*P)*oe,wt=h/(i*ne),st=te/(c*se),rt=pt/(l*re);return S(wt*wt+st*st+rt*rt+ae*st*rt)}function Ke(t,e){const n=t[0]-e[0],s=t[1]-e[1],r=t[2]-e[2];return n*n+s*s+r*r}function Ht(t,e){const n=y.rgb.lab.raw(t),s=y.rgb.lab.raw(e);return Wt(n,s)}class _{values;N;distMatrix;path;constructor(e,n=1,s=Ht){this.values=e.slice(),this.N=this.values.length,this.path=this.values.map((r,o)=>o),this.distMatrix=this.createDistMatrix(n,s)}static async awaitWorker(e){const n=await new Promise((s,r)=>{const o=i=>{e.removeEventListener("message",o),s(i.data)},a=i=>{e.removeEventListener("error",a),r(i)};e.addEventListener("message",o),e.addEventListener("error",a)});return e.terminate(),n}createDistMatrix(e,n){const s=this.values,r=this.N,o=Array(r).fill(0).map(()=>Array(r).fill(0));for(let a=0;a<r;a++)for(let i=a+1;i<r;i++){const c=Math.pow(n(s[a],s[i]),e);o[a][i]=c,o[i][a]=c}return o}totalDist(){const e=this.path,n=this.distMatrix;let s=0,r=e[0];for(let o=1,a=e.length;o<a;o++){const i=e[o];s+=n[r][i],r=i}return s}async nearestNeighborPath(e=0){const n=new Worker(new URL("/SortingSwatchesResearch/assets/NNP-CsMNQBdk.js",import.meta.url),{type:"module"});n.postMessage({N:this.N,distMatrix:this.distMatrix,startIndex:e}),this.path=await _.awaitWorker(n)}async twoOpt(){const e=new Worker(new URL("/SortingSwatchesResearch/assets/twoOpt-DdTLJvVE.js",import.meta.url),{type:"module"});e.postMessage({N:this.N,path:this.path,distMatrix:this.distMatrix}),this.path=await _.awaitWorker(e)}getValuesFromPath(e=this.path){return this.values=(e||this.path).map(n=>this.values[n])}}const Y=(t,e)=>{const n=y.rgb.lab.raw(t),s=y.rgb.lab.raw(e);return Wt(n,s)};function We(t,e=1){const n=t.length;if(n<=1)return 0;let s=0;for(let c=1;c<n;c++)s+=Math.pow(Y(t[c-1],t[c]),e);let r=0;for(let c=0;c<n;c++){let l=1/0;for(let h=0;h<n;h++){if(c===h)continue;const f=Y(t[c],t[h]);f<l&&(l=f)}r+=Math.pow(l,e)}const a=Math.pow(128,e)*(n-1),i=(s-r)/(a-r);return Math.max(0,Math.min(1,i))}function He(t,e){const n=[];return t%e&&t-1>=0&&n.push(t-1),t-e>=0&&n.push(t-e),n}function Xe(t,e,n=1){const s=t.length;if(s<=1)return 0;let r=0;for(let d=0;d<s;d++){const p=He(d,e);for(const b of p)r+=Math.pow(Y(t[d],t[b]),n)}let o=0;for(let d=0;d<s;d++){let p=1/0;for(let b=0;b<s;b++){if(d===b)continue;const w=Y(t[d],t[b]);w<p&&(p=w)}o+=Math.pow(p,n)}const a=128,i=Math.ceil(s/e),c=i*(e-1)-Math.max(0,e-(s%e||e)),l=(i-1)*e,h=c+l,f=Math.pow(a,n)*h,g=(r-o)/(f-o);return Math.max(0,Math.min(1,g))}function Ye(t,e){const n=Math.floor(1/We(e,3));t.querySelector(".score").textContent=String(n);const s=t.querySelector("ol");s&&(s.innerHTML="",e.forEach(([r,o,a])=>{const i=document.createElement("li");i.style.backgroundColor=`rgb(${r}, ${o}, ${a})`,s.appendChild(i)}))}function Ge(t){const e=[...document.querySelector("#one-d + .solutions").children],n=t.length;e.forEach(async(s,r)=>{if(s.classList.contains("not-solution"))return;let o=structuredClone(t);switch(r){case 0:case 1:break;case 2:o.sort(([a,i,c],[l,h,f])=>{const g=Math.atan2(Math.sqrt(3)*(i-c),2*a-i-c),d=Math.atan2(Math.sqrt(3)*(h-f),2*l-h-f);return g-d});break;case 3:o.sort(([a,i,c],[l,h,f])=>{const[,g]=y.rgb.hsl.raw(a,i,c),[,d]=y.rgb.hsl.raw(l,h,f);return g-d});break;case 4:o.sort(([a,i,c],[l,h,f])=>{const[,,g]=y.rgb.hsl.raw(a,i,c),[,,d]=y.rgb.hsl.raw(l,h,f);return g-d});break;case 5:o.sort(([a,i,c],[l,h,f])=>{const[,,g]=y.rgb.hsv.raw(a,i,c),[,,d]=y.rgb.hsv.raw(l,h,f);return g-d});break;case 6:o.sort(([a,i,c],[l,h,f])=>{const[g,d]=y.rgb.hsl.raw(a,i,c),[p,b]=y.rgb.hsl.raw(l,h,f),w=+(d>50),v=+(b>50);return w-v||g-p});break;case 7:o.sort(([a,i,c],[l,h,f])=>{const[g,,d]=y.rgb.hsl.raw(a,i,c),[p,,b]=y.rgb.hsl.raw(l,h,f),w=+(d>50),v=+(b>50);return w-v||g-p});break;case 8:o.sort(([a,i,c],[l,h,f])=>{const[g,,d]=y.rgb.hsv.raw(a,i,c),[p,,b]=y.rgb.hsv.raw(l,h,f),w=+(d>50),v=+(b>50);return w-v||g-p});break;case 9:{o.sort(([i,c,l],[h,f,g])=>{const d=Math.atan2(Math.sqrt(3)*(c-l),2*i-c-l),p=Math.atan2(Math.sqrt(3)*(f-g),2*h-f-g);return d-p});const a=new _(o);await a.twoOpt(),o=a.getValuesFromPath();break}case 10:{if(n<=1)break;const a=new _(o,3);await a.nearestNeighborPath(),o=a.getValuesFromPath();break}case 11:{if(n<=1)break;const a=new _(o,3);let i=[],c=1/0;for(let l=0;l<Math.min(n,120);l++){await a.nearestNeighborPath(l);const h=a.totalDist();h<c&&(c=h,i=a.path)}o=a.getValuesFromPath(i);break}case 12:{if(n<=1)break;const a=new _(o,3);await a.nearestNeighborPath(),await a.twoOpt(),o=a.getValuesFromPath();break}case 13:{if(n<=1)break;const a=new _(o,3);let i=[],c=1/0;for(let l=0;l<Math.min(n,120);l++){await a.nearestNeighborPath(l),await a.twoOpt();const h=a.totalDist();h<c&&(c=h,i=a.path)}o=a.getValuesFromPath(i);break}case 14:{if(n<=1)break;const a=new _(o,3,Ke);let i=[],c=1/0;for(let l=0;l<Math.min(n,120);l++){await a.nearestNeighborPath(l),await a.twoOpt();const h=a.totalDist();h<c&&(c=h,i=a.path)}o=a.getValuesFromPath(i);break}}Ye(s,o)})}function Qe(){[...document.querySelector("#one-d + .solutions").children].forEach(e=>{const n=e.querySelector(":scope > ol");n&&(n.innerHTML="")})}const G="settings1D",Ze={swatchAmount:44,swatchSizePx:30},O=new $("swatches-"+G,Ze),T=new Ut(document.querySelector("form#"+G)),xt=T.form.elements,Q={swatchAmount:xt.namedItem(G+"-swatch-amount"),swatchSizePx:xt.namedItem(G+"-swatch-size")};function Xt(){for(const t of Object.keys(Q))Q[t].value=String(O.value[t])}function Yt(){O.set("swatchAmount",+Q.swatchAmount.value),O.set("swatchSizePx",+Q.swatchSizePx.value)}function Gt(){Qe(),document.documentElement.style.setProperty("--swatch-size-1D",O.value.swatchSizePx+"px");const t=At(O.value.swatchAmount);Ge(t)}Xt();requestAnimationFrame(()=>requestAnimationFrame(Gt));T.form.addEventListener("submit",t=>{t.target instanceof HTMLFormElement&&(t.preventDefault(),Yt(),Gt())});const Je=T.form.querySelector('.actions button[name="settings-update"]');Je.addEventListener("click",()=>{Yt(),document.documentElement.style.setProperty("--swatch-size-1D",O.value.swatchSizePx+"px")});const tn=T.form.querySelector('.actions button[name="settings-reset"]');tn.addEventListener("click",()=>{O.reset(),Xt()});T.addValidator({name:"settings-swatch-amount",method:t=>+t.value>=1&&+t.value<=999,message:"Should be between 1 and 999"});T.addValidator({name:"settings-swatch-size",method:t=>+t.value>=1&&+t.value<=3200,message:"Should be between 1 and 3200 pixels"});class x{values;N;stride;distMatrix;path;constructor(e,n,s=1,r=Ht){this.values=e.slice(),this.N=this.values.length,this.stride=n,this.path=this.values.map((o,a)=>a),this.distMatrix=this.createDistMatrix(s,r)}static async awaitWorker(e){const n=await new Promise((s,r)=>{const o=i=>{e.removeEventListener("message",o),s(i.data)},a=i=>{e.removeEventListener("error",a),r(i)};e.addEventListener("message",o),e.addEventListener("error",a)});return e.terminate(),n}getNeighbors(e){const n=[];return e%this.stride<this.stride-1&&e+1<this.N&&n.push(e+1),e+this.stride<this.N&&n.push(e+this.stride),n}createDistMatrix(e,n){const s=this.values,r=this.N,o=Array(r).fill(0).map(()=>Array(r).fill(0));for(let a=0;a<r;a++)for(let i=a+1;i<r;i++){const c=Math.pow(n(s[a],s[i]),e);o[a][i]=c,o[i][a]=c}return o}totalDist(){const e=this.distMatrix;let n=0;for(let s=0;s<this.N;s++){const r=this.getNeighbors(s);for(const o of r)n+=e[this.path[s]][this.path[o]]}return n}straightPath(){this.path=this.values.map((e,n)=>n)}async snakePath(e=0){const n=new Worker(new URL("/SortingSwatchesResearch/assets/snake-C0hlRefn.js",import.meta.url),{type:"module"});n.postMessage({N:this.N,stride:this.stride,distMatrix:this.distMatrix,startIndex:e}),this.path=await x.awaitWorker(n)}async greedyPath(e=0){const n=new Worker(new URL("/SortingSwatchesResearch/assets/greedy-Bkqz6gSn.js",import.meta.url),{type:"module"});n.postMessage({N:this.N,stride:this.stride,distMatrix:this.distMatrix,startIndex:e}),this.path=await x.awaitWorker(n)}async twoOpt(e=1e8/this.N**2){const n=new Worker(new URL("/SortingSwatchesResearch/assets/twoOpt-DF6h8qV6.js",import.meta.url),{type:"module"});n.postMessage({N:this.N,stride:this.stride,path:this.path,distMatrix:this.distMatrix,maxImprovements:e}),this.path=await x.awaitWorker(n)}getValuesFromPath(e=this.path){return this.values=(e||this.path).map(n=>this.values[n])}}function en(t,e,n){const s=Math.floor(1/Xe(e,n,3));t.querySelector(".score").textContent=String(s);const r=t.querySelector("ol");if(r){r.innerHTML="";for(let o=0;o<e.length;o+=n){const a=document.createElement("li"),i=document.createElement("ol");for(let c=o;c<o+n&&c<e.length;c++){const[l,h,f]=e[c],g=document.createElement("li");g.style.backgroundColor=`rgb(${l}, ${h}, ${f})`,i.appendChild(g)}a.appendChild(i),r.appendChild(a)}}}function nn(t,e){const n=[...document.querySelector("#two-d + .solutions").children],s=t.length;n.forEach(async(r,o)=>{if(r.classList.contains("not-solution"))return;let a=structuredClone(t);switch(o){case 0:case 1:break;case 2:{if(s<=1)break;const i=new _(a,3);let c=[],l=1/0;for(let h=0;h<Math.min(s,6);h++){await i.nearestNeighborPath(h),await i.twoOpt();const f=i.totalDist();f<l&&(l=f,c=i.path)}a=i.getValuesFromPath(c);break}case 3:{if(s<=1)break;const i=new x(a,e,2);let c=[],l=1/0;for(let h=0;h<Math.min(s,12);h++){await i.snakePath(h),await i.twoOpt(1e9/i.N**2);const f=i.totalDist();f<l&&(l=f,c=i.path)}a=i.getValuesFromPath(c);break}case 4:{if(s<=1)break;const i=new x(a,e,2);let c=[],l=1/0;for(let h=0;h<Math.min(s,2);h++){await i.greedyPath(h),await i.twoOpt(6e9/i.N**2);const f=i.totalDist();f<l&&(l=f,c=i.path)}a=i.getValuesFromPath(c);break}case 5:{if(s<=1)break;const i=new x(a,e,2);await i.twoOpt(1e7/i.N),a=i.getValuesFromPath();break}case 6:{if(s<=1)break;const i=new _(a,2);let c=[],l=1/0;for(let f=0;f<Math.min(s,12);f++){await i.nearestNeighborPath(f),await i.twoOpt();const g=i.totalDist();g<l&&(l=g,c=i.path)}a=i.getValuesFromPath(c);const h=new x(a,e,2);await h.twoOpt(2e8/h.N),a=h.getValuesFromPath();break}}en(r,a,e)})}function sn(){[...document.querySelector("#two-d + .solutions").children].forEach(e=>{const n=e.querySelector(":scope > ol");n&&(n.innerHTML="")})}const C="settings2D",rn={swatchAmountX:20,swatchAmountY:20,swatchSizePx:30},M=new $("swatches-"+C,rn),R=new Ut(document.querySelector("form#"+C)),it=R.form.elements,I={swatchAmountX:it.namedItem(C+"-swatch-amount-x"),swatchAmountY:it.namedItem(C+"-swatch-amount-y"),swatchSizePx:it.namedItem(C+"-swatch-size")};function Qt(){for(const t of Object.keys(I))I[t].value=String(M.value[t])}function Zt(){M.set("swatchAmountX",+I.swatchAmountX.value),M.set("swatchAmountY",+I.swatchAmountY.value),M.set("swatchSizePx",+I.swatchSizePx.value)}function Jt(){sn(),document.documentElement.style.setProperty("--swatch-size-2D",M.value.swatchSizePx+"px");const t=At(M.value.swatchAmountX*M.value.swatchAmountY);nn(t,M.value.swatchAmountX)}Qt();requestAnimationFrame(()=>requestAnimationFrame(Jt));R.form.addEventListener("submit",t=>{t.target instanceof HTMLFormElement&&(t.preventDefault(),Zt(),Jt())});const on=R.form.querySelector('.actions button[name="settings-update"]');on.addEventListener("click",()=>{Zt(),document.documentElement.style.setProperty("--swatch-size-2D",M.value.swatchSizePx+"px")});const an=R.form.querySelector('.actions button[name="settings-reset"]');an.addEventListener("click",()=>{M.reset(),Qt()});R.addValidator({name:"settings-swatch-amount-x",method:t=>+t.value>=1&&+t.value*+I.swatchAmountY.value<1e3,message:"Total amount of swatches should be between 1 and 999"});R.addValidator({name:"settings-swatch-amount-x",method:t=>+t.value>=1&&+t.value*+I.swatchAmountX.value<1e3,message:"Total amount of swatches should be between 1 and 999"});R.addValidator({name:"settings-swatch-size",method:t=>+t.value>=1&&+t.value<=3200,message:"Should be between 1 and 3200 pixels"});
